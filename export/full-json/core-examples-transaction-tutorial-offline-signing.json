{
 "_id": "5db1c913aec2df0035f3ad3c",
 "version": "5daf2e65f4109c0040fd51e5",
 "project": "5daf2e65f4109c0040fd51e1",
 "user": "5b8400d7185d5e00036dcc3b",
 "parentDoc": "5db1c7f980dc4f02b5e4131a",
 "category": "5db19f199332b800310886f8",
 "__v": 1,
 "updates": [],
 "updatedAt": "2019-11-14T19:20:27.335Z",
 "createdAt": "2019-10-24T15:53:55.192Z",
 "next": {
  "pages": [
   {
    "category": "Core Examples",
    "slug": "core-examples-transaction-tutorial-p2sh-multisig",
    "name": "P2SH Multisig",
    "icon": "file-text-o",
    "type": "doc"
   }
  ],
  "description": ""
 },
 "link_external": false,
 "link_url": "",
 "sync_unique": "",
 "hidden": false,
 "api": {
  "results": {
   "codes": [
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 200
    },
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 400
    }
   ]
  },
  "auth": "required",
  "params": [],
  "url": "",
  "method": "get"
 },
 "isReference": false,
 "order": 3,
 "body": "We will now spend the <<glossary:transaction>> created in the [Complex Raw Transaction subsection](core-examples-transaction-tutorial-complex-raw-transaction) without sending it to the local <<glossary:node>> first. This is the same basic process used by <<glossary:wallet>> programs for offline signing---which generally means signing a transaction without access to the current UTXO set.\n\nOffline signing is safe. However, in this example we will also be spending an <<glossary:output>> which is not part of the <<glossary:block chain>> because the transaction containing it has never been broadcast. That can be unsafe:\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"**Warning:** Transactions which spend outputs from unconfirmed transactions are vulnerable to transaction malleability. Be sure to read about transaction malleability and adopt good practices before spending unconfirmed transactions on mainnet.\",\n  \"title\": \"Unconfirmed Transaction Spending\"\n}\n[/block]\nPut the previously signed (but not sent) transaction into a shell variable.\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"OLD_SIGNED_RAW_TX=0100000002843d61e81058f0e682313b9e6f45ce67464b41fd8bb0\\\\\\nf84678135aa56d596dea00000000494830450221009f7f356c0cc2d3337b5f76dfc6de9f\\\\\\n9be7c8c5ac2074cbeeba4815b90329602002207790f23361480e2a5a2d1fa6e293ccd5cd\\\\\\n01279ad301176f091b84d6dd8e8f6501ffffffff30d100f7762956100a2396403c60e13e\\\\\\n7a13520167acc6d38978ec33ada44cf8000000006a47304402207867e88e3fe2c926df29\\\\\\n376d77eba81daf9f4a557344d4f02e9c7dcee96a51e4022076274c2365dc069e7ef797c9\\\\\\n5c75ab6e01ca3757342f3e6f21a3d9d01086efb7012102ff9005f79aa4c22ac48fa93d9b\\\\\\n7f40f321db1c13cd70cf08bdab3e23c8d19620ffffffff02f04c3ba40b0000001976a914\\\\\\nec73fe6129b249617bb5f20c8760708055fb6fdb88ac00ca9a3b000000001976a914cb7a\\\\\\n56b046479f8c247875d672d3e1aed18c33f488ac00000000\",\n      \"language\": \"shell\"\n    }\n  ]\n}\n[/block]\n\n# 1. Decode signed transaction\n\nDecode the signed <<glossary:raw transaction>> so we can get its <<glossary:TXID>>. Also, choose a specific one of its UTXOs to spend and save that UTXO's <<glossary:output index>> number (vout) and hex <<glossary:pubkey script>> (scriptPubKey) into shell variables.\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"dash-cli -regtest decoderawtransaction $OLD_SIGNED_RAW_TX\",\n      \"language\": \"shell\"\n    }\n  ]\n}\n[/block]\n``` json\n{\n  \"txid\": \"5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb781077\",\n  \"size\": 339,\n  \"version\": 1,\n  \"locktime\": 0,\n  \"vin\": [\n    {\n      \"txid\": \"ea6d596da55a137846f8b08bfd414b4667ce456f9e3b3182e6f05810e86\\\n                13d84\",\n      \"vout\": 0,\n      \"scriptSig\": {\n        \"asm\": \"30450221009f7f356c0cc2d3337b5f76dfc6de9f9be7c8c5ac2074cbee\\\n                ba4815b90329602002207790f23361480e2a5a2d1fa6e293ccd5cd0127\\\n                9ad301176f091b84d6dd8e8f65[ALL]\",\n        \"hex\": \"4830450221009f7f356c0cc2d3337b5f76dfc6de9f9be7c8c5ac2074cb\\\n                eeba4815b90329602002207790f23361480e2a5a2d1fa6e293ccd5cd01\\\n                279ad301176f091b84d6dd8e8f6501\"\n      },\n      \"sequence\": 4294967295\n    },\n    {\n      \"txid\": \"f84ca4ad33ec7889d3c6ac670152137a3ee1603c4096230a10562976f70\\\n                0d130\",\n      \"vout\": 0,\n      \"scriptSig\": {\n        \"asm\": \"304402207867e88e3fe2c926df29376d77eba81daf9f4a557344d4f02e\\\n                9c7dcee96a51e4022076274c2365dc069e7ef797c95c75ab6e01ca3757\\\n                342f3e6f21a3d9d01086efb7[ALL] 02ff9005f79aa4c22ac48fa93d9b\\\n                7f40f321db1c13cd70cf08bdab3e23c8d19620\",\n        \"hex\": \"47304402207867e88e3fe2c926df29376d77eba81daf9f4a557344d4f0\\\n                2e9c7dcee96a51e4022076274c2365dc069e7ef797c95c75ab6e01ca37\\\n                57342f3e6f21a3d9d01086efb7012102ff9005f79aa4c22ac48fa93d9b\\\n                7f40f321db1c13cd70cf08bdab3e23c8d19620\"\n      },\n      \"sequence\": 4294967295\n    }\n  ],\n  \"vout\": [\n    {\n      \"value\": 499.99990000,\n      \"valueSat\": 49999990000,\n      \"n\": 0,\n      \"scriptPubKey\": {\n        \"asm\": \"OP_DUP OP_HASH160 ec73fe6129b249617bb5f20c8760708055fb6fdb\\\n                OP_EQUALVERIFY OP_CHECKSIG\",\n        \"hex\": \"76a914ec73fe6129b249617bb5f20c8760708055fb6fdb88ac\",\n        \"reqSigs\": 1,\n        \"type\": \"pubkeyhash\",\n        \"addresses\": [\n          \"yhshGrdbh3rWt9EPaSi7xSGRFMvFdzTZ8n\"\n        ]\n      }\n    },\n    {\n      \"value\": 10.00000000,\n      \"valueSat\": 1000000000,\n      \"n\": 1,\n      \"scriptPubKey\": {\n        \"asm\": \"OP_DUP OP_HASH160 cb7a56b046479f8c247875d672d3e1aed18c33f4\\\n                OP_EQUALVERIFY OP_CHECKSIG\",\n        \"hex\": \"76a914cb7a56b046479f8c247875d672d3e1aed18c33f488ac\",\n        \"reqSigs\": 1,\n        \"type\": \"pubkeyhash\",\n        \"addresses\": [\n          \"yesLaP5XFTaLZiWAo2zK8mFfUCtV8rRhKw\"\n        ]\n      }\n    }\n  ]\n}\n```\n``` bash\n\n> UTXO_TXID=5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb781077\n> UTXO_VOUT=1\n> UTXO_OUTPUT_SCRIPT=76a914cb7a56b046479f8c247875d672d3e1aed18c33f488ac\n```\n\n# 2. Get new address\n\nGet a new <<glossary:address>> to spend the <<glossary:duffs>> to.\n\n``` bash\n> dash-cli -regtest getnewaddress\nyfijhy7gYY34J2U77xFKdMwfA8k5mVnSRa\n\n> NEW_ADDRESS=yfijhy7gYY34J2U77xFKdMwfA8k5mVnSRa\n```\n\n# 3. Create raw transaction\n\nCreate the raw transaction the same way we've done in the previous subsections.\n\n``` bash\n## Outputs - inputs = transaction fee, so always double-check your math!\n> dash-cli -regtest createrawtransaction '''\n    [\n      {\n        \"txid\": \"'$UTXO_TXID'\",\n        \"vout\": '$UTXO_VOUT'\n      }\n    ]\n    ''' '''\n    {\n      \"'$NEW_ADDRESS'\": 9.9999\n    }'''\n0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1c4276664794d64c9\\\n24cf61fd5e0100000000ffffffff01f0a29a3b000000001976a914d4d2078580\\\na9eea0ca9368d1c99c097279b8081f88ac00000000\n\n> RAW_TX=0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1c427666[...]\n```\n\n# 4. Sign raw transaction\n\nAttempt to sign the <<glossary:raw transaction>> without any special arguments, the way we successfully signed the the raw transaction in the [Simple Raw Transaction subsection](core-examples-transaction-tutorial-simple-raw-transaction). If you've read the [Transaction section](core-guide-transactions) of the guide, you may know why the call fails and leaves the raw transaction hex unchanged.\n\n![Old Transaction Data Required To Be Signed](https://dash-docs.github.io/img/dev/en-signing-output-to-spend.svg)\n\nAs illustrated above, the data that gets signed includes the <<glossary:TXID>> and vout from the previous transaction.  That information is included in the `createrawtransaction` raw transaction.  But the data that gets signed also includes the <<glossary:pubkey script>> from the previous transaction, even though it doesn't appear in either the unsigned or signed transaction.\n\nIn the other raw transaction subsections above, the previous <<glossary:output>> was part of the UTXO set known to the wallet, so the wallet was able to use the TXID and <<glossary:output index>> number to find the previous <<glossary:pubkey script>> and insert it automatically.\n\n## 4a. Without Pubkey Script\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"Note: This step demonstrates the error returned when an unknown output is referenced.\"\n}\n[/block]\nIn this case, you're spending an <<glossary:output>> which is unknown to the wallet, so it can't automatically insert the previous pubkey script.\n\n``` bash\n> dash-cli -regtest signrawtransaction $RAW_TX\n```\n``` json\n{\n  \"hex\": \"0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1c4276664794d64c9\\\n          24cf61fd5e0100000000ffffffff01f0a29a3b000000001976a914d4d2078580\\\n          a9eea0ca9368d1c99c097279b8081f88ac00000000\",\n  \"complete\": false,\n  \"errors\": [\n    {\n      \"txid\": \"5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb7\\\n                81077\",\n      \"vout\": 1,\n      \"scriptSig\": \"\",\n      \"sequence\": 4294967295,\n      \"error\": \"Input not found or already spent\"\n    }\n  ]\n}\n```\n\n## 4b. With Pubkey Script\n\nSuccessfully sign the transaction by providing the previous pubkey script and other required input data.\n\nThis specific operation is typically what offline signing wallets do. The online wallet creates the raw transaction and gets the previous pubkey scripts for all the inputs. The user brings this information to the offline wallet. After displaying the transaction details to the user, the offline wallet signs the transaction as we did above. The user takes the signed transaction back to the online wallet, which broadcasts it.\n\n``` bash\n> dash-cli -regtest signrawtransaction $RAW_TX '''\n    [\n      {\n        \"txid\": \"'$UTXO_TXID'\",\n        \"vout\": '$UTXO_VOUT',\n        \"scriptPubKey\": \"'$UTXO_OUTPUT_SCRIPT'\"\n      }\n    ]'''\n```\n``` json\n{\n  \"hex\": \"0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1c4276664794d64c9\\\n          24cf61fd5e010000006a47304402204ee3aae064dccedb511a84fcade3f35f2d\\\n          95119283e2e9f23659d91ce799cb6d02203a4cecbd7c154de8394b9505814f1e\\\n          c842e890980e7c4c20ed182f09a71d65f3012103b0b12fb25b6382b0680ce4b0\\\n          379bc201c4cbb391d3c0e171181f24c9a5df1468ffffffff01f0a29a3b000000\\\n          001976a914d4d2078580a9eea0ca9368d1c99c097279b8081f88ac00000000\",\n  \"complete\": true\n}\n```\n``` bash\n\n> SIGNED_RAW_TX=0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1[...]\n```\n\n# 5. Send raw transaction\n\n## 5a. Second transaction\n\nAttempt to broadcast the second transaction before we've broadcast the first transaction.  The <<glossary:node>> rejects this attempt because the second transaction spends an <<glossary:output>> which is not a UTXO the node knows about.\n\n``` bash\n> dash-cli -regtest sendrawtransaction $SIGNED_RAW_TX\n```\n``` bash\nerror code: -25\nerror message:\nMissing inputs\n\nerror: {\"code\":-22,\"message\":\"TX rejected\"}\n```\n\n## 5b. First transaction\n\nBroadcast the first transaction, which succeeds, and then broadcast the second transaction---which also now succeeds because the node now sees the UTXO.\n\n``` bash\n> dash-cli -regtest sendrawtransaction $OLD_SIGNED_RAW_TX\n5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb781077\n> dash-cli -regtest sendrawtransaction $SIGNED_RAW_TX\nf89deefb927fbd03c5acab194de2ba8f98ab160b9c4b3f57bde63073c4b5f060\n```\n\n# 6. Check mempool\n\nWe have once again not generated an additional block, so the transactions above have not yet become part of the regtest block chain.  However, they are part of the local node's memory pool.\n\n``` bash\n> dash-cli -regtest getrawmempool\n```\n``` json\n[\n  \"f89deefb927fbd03c5acab194de2ba8f98ab160b9c4b3f57bde63073c4b5f060\",\n  \"5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb781077\"\n]\n```\n\nRemove old shell variables.\n\n``` bash\n> unset OLD_SIGNED_RAW_TX SIGNED_RAW_TX RAW_TX [...]\n```",
 "excerpt": "",
 "slug": "core-examples-transaction-tutorial-offline-signing",
 "type": "basic",
 "metadata": {
  "description": "",
  "title": "",
  "image": []
 },
 "title": "Offline Signing",
 "id": "5db1c913aec2df0035f3ad3c",
 "isApi": false,
 "body_html": "<div class=\"magic-block-textarea\"><p>We will now spend the &lt;&lt;glossary:transaction&gt;&gt; created in the <a href=\"core-examples-transaction-tutorial-complex-raw-transaction\">Complex Raw Transaction subsection</a> without sending it to the local &lt;&lt;glossary:node&gt;&gt; first. This is the same basic process used by &lt;&lt;glossary:wallet&gt;&gt; programs for offline signing---which generally means signing a transaction without access to the current UTXO set.</p>\n<p>Offline signing is safe. However, in this example we will also be spending an &lt;&lt;glossary:output&gt;&gt; which is not part of the &lt;&lt;glossary:block chain&gt;&gt; because the transaction containing it has never been broadcast. That can be unsafe:</p>\n\n</div>\n<div class=\"magic-block-callout type-warning \">\n\t<h3><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i>Unconfirmed Transaction Spending\n\t</h3>\n\t<div class=\"callout-body\"><p><strong>Warning:</strong> Transactions which spend outputs from unconfirmed transactions are vulnerable to transaction malleability. Be sure to read about transaction malleability and adopt good practices before spending unconfirmed transactions on mainnet.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>Put the previously signed (but not sent) transaction into a shell variable.</p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Shell</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(613)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-613\">OLD_SIGNED_RAW_TX=0100000002843d61e81058f0e682313b9e6f45ce67464b41fd8bb0\\\nf84678135aa56d596dea00000000494830450221009f7f356c0cc2d3337b5f76dfc6de9f\\\n9be7c8c5ac2074cbeeba4815b90329602002207790f23361480e2a5a2d1fa6e293ccd5cd\\\n01279ad301176f091b84d6dd8e8f6501ffffffff30d100f7762956100a2396403c60e13e\\\n7a13520167acc6d38978ec33ada44cf8000000006a47304402207867e88e3fe2c926df29\\\n376d77eba81daf9f4a557344d4f02e9c7dcee96a51e4022076274c2365dc069e7ef797c9\\\n5c75ab6e01ca3757342f3e6f21a3d9d01086efb7012102ff9005f79aa4c22ac48fa93d9b\\\n7f40f321db1c13cd70cf08bdab3e23c8d19620ffffffff02f04c3ba40b0000001976a914\\\nec73fe6129b249617bb5f20c8760708055fb6fdb88ac00ca9a3b000000001976a914cb7a\\\n56b046479f8c247875d672d3e1aed18c33f488ac00000000</textarea>\n\t\t\t<pre id=\"code-613\"><code><span class='cm-s-neo'><span class=\"cm-def\">OLD_SIGNED_RAW_TX</span><span class=\"cm-operator\">=</span>0100000002843d61e81058f0e682313b9e6f45ce67464b41fd8bb0\\\nf84678135aa56d596dea00000000494830450221009f7f356c0cc2d3337b5f76dfc6de9f\\\n9be7c8c5ac2074cbeeba4815b90329602002207790f23361480e2a5a2d1fa6e293ccd5cd\\\n01279ad301176f091b84d6dd8e8f6501ffffffff30d100f7762956100a2396403c60e13e\\\n7a13520167acc6d38978ec33ada44cf8000000006a47304402207867e88e3fe2c926df29\\\n376d77eba81daf9f4a557344d4f02e9c7dcee96a51e4022076274c2365dc069e7ef797c9\\\n5c75ab6e01ca3757342f3e6f21a3d9d01086efb7012102ff9005f79aa4c22ac48fa93d9b\\\n7f40f321db1c13cd70cf08bdab3e23c8d19620ffffffff02f04c3ba40b0000001976a914\\\nec73fe6129b249617bb5f20c8760708055fb6fdb88ac00ca9a3b000000001976a914cb7a\\\n56b046479f8c247875d672d3e1aed18c33f488ac00000000</span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-1-decode-signed-transaction\"></div>1. Decode signed transaction<a class=\"fa fa-anchor\" href=\"#section-1-decode-signed-transaction\"></a></h1>\n<p>Decode the signed &lt;&lt;glossary:raw transaction&gt;&gt; so we can get its &lt;&lt;glossary:TXID&gt;&gt;. Also, choose a specific one of its UTXOs to spend and save that UTXO&#39;s &lt;&lt;glossary:output index&gt;&gt; number (vout) and hex &lt;&lt;glossary:pubkey script&gt;&gt; (scriptPubKey) into shell variables.</p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Shell</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(620)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-620\">dash-cli -regtest decoderawtransaction $OLD_SIGNED_RAW_TX</textarea>\n\t\t\t<pre id=\"code-620\"><code><span class='cm-s-neo'>dash-cli <span class=\"cm-attribute\">-regtest</span> decoderawtransaction <span class=\"cm-def\">$OLD_SIGNED_RAW_TX</span></span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><pre><code class=\"lang-json\"><span class='cm-s-neo'>{\n  <span class=\"cm-property\">\"txid\"</span>: <span class=\"cm-string\">\"5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb781077\"</span>,\n  <span class=\"cm-property\">\"size\"</span>: <span class=\"cm-number\">339</span>,\n  <span class=\"cm-property\">\"version\"</span>: <span class=\"cm-number\">1</span>,\n  <span class=\"cm-property\">\"locktime\"</span>: <span class=\"cm-number\">0</span>,\n  <span class=\"cm-property\">\"vin\"</span>: [\n    {\n      <span class=\"cm-property\">\"txid\"</span>: <span class=\"cm-string\">\"ea6d596da55a137846f8b08bfd414b4667ce456f9e3b3182e6f05810e86\\</span>\n                <span class=\"cm-string\">13d84\"</span>,\n      <span class=\"cm-string\">\"vout\"</span>: <span class=\"cm-number\">0</span>,\n      <span class=\"cm-string\">\"scriptSig\"</span>: {\n        <span class=\"cm-string\">\"asm\"</span>: <span class=\"cm-string\">\"30450221009f7f356c0cc2d3337b5f76dfc6de9f9be7c8c5ac2074cbee\\</span>\n                <span class=\"cm-string\">ba4815b90329602002207790f23361480e2a5a2d1fa6e293ccd5cd0127\\</span>\n                <span class=\"cm-string\">9ad301176f091b84d6dd8e8f65[ALL]\"</span>,\n        <span class=\"cm-string\">\"hex\"</span>: <span class=\"cm-string\">\"4830450221009f7f356c0cc2d3337b5f76dfc6de9f9be7c8c5ac2074cb\\</span>\n                <span class=\"cm-string\">eeba4815b90329602002207790f23361480e2a5a2d1fa6e293ccd5cd01\\</span>\n                <span class=\"cm-string\">279ad301176f091b84d6dd8e8f6501\"</span>\n      },\n      <span class=\"cm-string\">\"sequence\"</span>: <span class=\"cm-number\">4294967295</span>\n    },\n    {\n      <span class=\"cm-property\">\"txid\"</span>: <span class=\"cm-string\">\"f84ca4ad33ec7889d3c6ac670152137a3ee1603c4096230a10562976f70\\</span>\n                <span class=\"cm-string\">0d130\"</span>,\n      <span class=\"cm-string\">\"vout\"</span>: <span class=\"cm-number\">0</span>,\n      <span class=\"cm-string\">\"scriptSig\"</span>: {\n        <span class=\"cm-string\">\"asm\"</span>: <span class=\"cm-string\">\"304402207867e88e3fe2c926df29376d77eba81daf9f4a557344d4f02e\\</span>\n                <span class=\"cm-string\">9c7dcee96a51e4022076274c2365dc069e7ef797c95c75ab6e01ca3757\\</span>\n                <span class=\"cm-string\">342f3e6f21a3d9d01086efb7[ALL] 02ff9005f79aa4c22ac48fa93d9b\\</span>\n                <span class=\"cm-string\">7f40f321db1c13cd70cf08bdab3e23c8d19620\"</span>,\n        <span class=\"cm-string\">\"hex\"</span>: <span class=\"cm-string\">\"47304402207867e88e3fe2c926df29376d77eba81daf9f4a557344d4f0\\</span>\n                <span class=\"cm-string\">2e9c7dcee96a51e4022076274c2365dc069e7ef797c95c75ab6e01ca37\\</span>\n                <span class=\"cm-string\">57342f3e6f21a3d9d01086efb7012102ff9005f79aa4c22ac48fa93d9b\\</span>\n                <span class=\"cm-string\">7f40f321db1c13cd70cf08bdab3e23c8d19620\"</span>\n      },\n      <span class=\"cm-string\">\"sequence\"</span>: <span class=\"cm-number\">4294967295</span>\n    }\n  ],\n  <span class=\"cm-string\">\"vout\"</span>: [\n    {\n      <span class=\"cm-property\">\"value\"</span>: <span class=\"cm-number\">499.99990000</span>,\n      <span class=\"cm-property\">\"valueSat\"</span>: <span class=\"cm-number\">49999990000</span>,\n      <span class=\"cm-property\">\"n\"</span>: <span class=\"cm-number\">0</span>,\n      <span class=\"cm-property\">\"scriptPubKey\"</span>: {\n        <span class=\"cm-property\">\"asm\"</span>: <span class=\"cm-string\">\"OP_DUP OP_HASH160 ec73fe6129b249617bb5f20c8760708055fb6fdb\\</span>\n                <span class=\"cm-string\">OP_EQUALVERIFY OP_CHECKSIG\"</span>,\n        <span class=\"cm-string\">\"hex\"</span>: <span class=\"cm-string\">\"76a914ec73fe6129b249617bb5f20c8760708055fb6fdb88ac\"</span>,\n        <span class=\"cm-string\">\"reqSigs\"</span>: <span class=\"cm-number\">1</span>,\n        <span class=\"cm-string\">\"type\"</span>: <span class=\"cm-string\">\"pubkeyhash\"</span>,\n        <span class=\"cm-string\">\"addresses\"</span>: [\n          <span class=\"cm-string\">\"yhshGrdbh3rWt9EPaSi7xSGRFMvFdzTZ8n\"</span>\n        ]\n      }\n    },\n    {\n      <span class=\"cm-string\">\"value\"</span>: <span class=\"cm-number\">10.00000000</span>,\n      <span class=\"cm-string\">\"valueSat\"</span>: <span class=\"cm-number\">1000000000</span>,\n      <span class=\"cm-string\">\"n\"</span>: <span class=\"cm-number\">1</span>,\n      <span class=\"cm-string\">\"scriptPubKey\"</span>: {\n        <span class=\"cm-string\">\"asm\"</span>: <span class=\"cm-string\">\"OP_DUP OP_HASH160 cb7a56b046479f8c247875d672d3e1aed18c33f4\\</span>\n                <span class=\"cm-string\">OP_EQUALVERIFY OP_CHECKSIG\"</span>,\n        <span class=\"cm-string\">\"hex\"</span>: <span class=\"cm-string\">\"76a914cb7a56b046479f8c247875d672d3e1aed18c33f488ac\"</span>,\n        <span class=\"cm-string\">\"reqSigs\"</span>: <span class=\"cm-number\">1</span>,\n        <span class=\"cm-string\">\"type\"</span>: <span class=\"cm-string\">\"pubkeyhash\"</span>,\n        <span class=\"cm-string\">\"addresses\"</span>: [\n          <span class=\"cm-string\">\"yesLaP5XFTaLZiWAo2zK8mFfUCtV8rRhKw\"</span>\n        ]\n      }\n    }\n  ]\n}</span>\n</code></pre>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>\n&gt; <span class=\"cm-def\">UTXO_TXID</span><span class=\"cm-operator\">=</span>5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb781077\n&gt; <span class=\"cm-def\">UTXO_VOUT</span><span class=\"cm-operator\">=</span><span class=\"cm-number\">1</span>\n&gt; <span class=\"cm-def\">UTXO_OUTPUT_SCRIPT</span><span class=\"cm-operator\">=</span>76a914cb7a56b046479f8c247875d672d3e1aed18c33f488ac</span>\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-2-get-new-address\"></div>2. Get new address<a class=\"fa fa-anchor\" href=\"#section-2-get-new-address\"></a></h1>\n<p>Get a new &lt;&lt;glossary:address&gt;&gt; to spend the &lt;&lt;glossary:duffs&gt;&gt; to.</p>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>&gt; dash-cli <span class=\"cm-attribute\">-regtest</span> getnewaddress\nyfijhy7gYY34J2U77xFKdMwfA8k5mVnSRa\n\n&gt; <span class=\"cm-def\">NEW_ADDRESS</span><span class=\"cm-operator\">=</span>yfijhy7gYY34J2U77xFKdMwfA8k5mVnSRa</span>\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-3-create-raw-transaction\"></div>3. Create raw transaction<a class=\"fa fa-anchor\" href=\"#section-3-create-raw-transaction\"></a></h1>\n<p>Create the raw transaction the same way we&#39;ve done in the previous subsections.</p>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'><span class=\"cm-comment\">## Outputs - inputs = transaction fee, so always double-check your math!</span>\n&gt; dash-cli <span class=\"cm-attribute\">-regtest</span> createrawtransaction <span class=\"cm-string\">'''</span>\n<span class=\"cm-string\">    [</span>\n<span class=\"cm-string\">      {</span>\n<span class=\"cm-string\">        \"txid\": \"'</span><span class=\"cm-def\">$UTXO_TXID</span><span class=\"cm-string\">'\",</span>\n<span class=\"cm-string\">        \"vout\": '</span><span class=\"cm-def\">$UTXO_VOUT</span><span class=\"cm-string\">'</span>\n<span class=\"cm-string\">      }</span>\n<span class=\"cm-string\">    ]</span>\n<span class=\"cm-string\">    '''</span> <span class=\"cm-string\">'''</span>\n<span class=\"cm-string\">    {</span>\n<span class=\"cm-string\">      \"'</span><span class=\"cm-def\">$NEW_ADDRESS</span><span class=\"cm-string\">'\": 9.9999</span>\n<span class=\"cm-string\">    }'''</span>\n0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1c4276664794d64c9\\\n24cf61fd5e0100000000ffffffff01f0a29a3b000000001976a914d4d2078580\\\na9eea0ca9368d1c99c097279b8081f88ac00000000\n\n&gt; <span class=\"cm-def\">RAW_TX</span><span class=\"cm-operator\">=</span>0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1c427666[...]</span>\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-4-sign-raw-transaction\"></div>4. Sign raw transaction<a class=\"fa fa-anchor\" href=\"#section-4-sign-raw-transaction\"></a></h1>\n<p>Attempt to sign the &lt;&lt;glossary:raw transaction&gt;&gt; without any special arguments, the way we successfully signed the the raw transaction in the <a href=\"core-examples-transaction-tutorial-simple-raw-transaction\">Simple Raw Transaction subsection</a>. If you&#39;ve read the <a href=\"core-guide-transactions\">Transaction section</a> of the guide, you may know why the call fails and leaves the raw transaction hex unchanged.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/en-signing-output-to-spend.svg\" alt=\"Old Transaction Data Required To Be Signed\"></p>\n<p>As illustrated above, the data that gets signed includes the &lt;&lt;glossary:TXID&gt;&gt; and vout from the previous transaction.  That information is included in the <code>createrawtransaction</code> raw transaction.  But the data that gets signed also includes the &lt;&lt;glossary:pubkey script&gt;&gt; from the previous transaction, even though it doesn&#39;t appear in either the unsigned or signed transaction.</p>\n<p>In the other raw transaction subsections above, the previous &lt;&lt;glossary:output&gt;&gt; was part of the UTXO set known to the wallet, so the wallet was able to use the TXID and &lt;&lt;glossary:output index&gt;&gt; number to find the previous &lt;&lt;glossary:pubkey script&gt;&gt; and insert it automatically.</p>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-4-a-without-pubkey-script\"></div>4a. Without Pubkey Script<a class=\"fa fa-anchor\" href=\"#section-4-a-without-pubkey-script\"></a></h2>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>Note: This step demonstrates the error returned when an unknown output is referenced.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>In this case, you&#39;re spending an &lt;&lt;glossary:output&gt;&gt; which is unknown to the wallet, so it can&#39;t automatically insert the previous pubkey script.</p>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>&gt; dash-cli <span class=\"cm-attribute\">-regtest</span> signrawtransaction <span class=\"cm-def\">$RAW_TX</span></span>\n</code></pre>\n<pre><code class=\"lang-json\"><span class='cm-s-neo'>{\n  <span class=\"cm-property\">\"hex\"</span>: <span class=\"cm-string\">\"0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1c4276664794d64c9\\</span>\n          <span class=\"cm-string\">24cf61fd5e0100000000ffffffff01f0a29a3b000000001976a914d4d2078580\\</span>\n          <span class=\"cm-string\">a9eea0ca9368d1c99c097279b8081f88ac00000000\"</span>,\n  <span class=\"cm-string\">\"complete\"</span>: <span class=\"cm-atom\">false</span>,\n  <span class=\"cm-string\">\"errors\"</span>: [\n    {\n      <span class=\"cm-string\">\"txid\"</span>: <span class=\"cm-string\">\"5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb7\\</span>\n                <span class=\"cm-string\">81077\"</span>,\n      <span class=\"cm-string\">\"vout\"</span>: <span class=\"cm-number\">1</span>,\n      <span class=\"cm-string\">\"scriptSig\"</span>: <span class=\"cm-string\">\"\"</span>,\n      <span class=\"cm-string\">\"sequence\"</span>: <span class=\"cm-number\">4294967295</span>,\n      <span class=\"cm-string\">\"error\"</span>: <span class=\"cm-string\">\"Input not found or already spent\"</span>\n    }\n  ]\n}</span>\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-4-b-with-pubkey-script\"></div>4b. With Pubkey Script<a class=\"fa fa-anchor\" href=\"#section-4-b-with-pubkey-script\"></a></h2>\n<p>Successfully sign the transaction by providing the previous pubkey script and other required input data.</p>\n<p>This specific operation is typically what offline signing wallets do. The online wallet creates the raw transaction and gets the previous pubkey scripts for all the inputs. The user brings this information to the offline wallet. After displaying the transaction details to the user, the offline wallet signs the transaction as we did above. The user takes the signed transaction back to the online wallet, which broadcasts it.</p>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>&gt; dash-cli <span class=\"cm-attribute\">-regtest</span> signrawtransaction <span class=\"cm-def\">$RAW_TX</span> <span class=\"cm-string\">'''</span>\n<span class=\"cm-string\">    [</span>\n<span class=\"cm-string\">      {</span>\n<span class=\"cm-string\">        \"txid\": \"'</span><span class=\"cm-def\">$UTXO_TXID</span><span class=\"cm-string\">'\",</span>\n<span class=\"cm-string\">        \"vout\": '</span><span class=\"cm-def\">$UTXO_VOUT</span><span class=\"cm-string\">',</span>\n<span class=\"cm-string\">        \"scriptPubKey\": \"'</span><span class=\"cm-def\">$UTXO_OUTPUT_SCRIPT</span><span class=\"cm-string\">'\"</span>\n<span class=\"cm-string\">      }</span>\n<span class=\"cm-string\">    ]'''</span></span>\n</code></pre>\n<pre><code class=\"lang-json\"><span class='cm-s-neo'>{\n  <span class=\"cm-property\">\"hex\"</span>: <span class=\"cm-string\">\"0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1c4276664794d64c9\\</span>\n          <span class=\"cm-string\">24cf61fd5e010000006a47304402204ee3aae064dccedb511a84fcade3f35f2d\\</span>\n          <span class=\"cm-string\">95119283e2e9f23659d91ce799cb6d02203a4cecbd7c154de8394b9505814f1e\\</span>\n          <span class=\"cm-string\">c842e890980e7c4c20ed182f09a71d65f3012103b0b12fb25b6382b0680ce4b0\\</span>\n          <span class=\"cm-string\">379bc201c4cbb391d3c0e171181f24c9a5df1468ffffffff01f0a29a3b000000\\</span>\n          <span class=\"cm-string\">001976a914d4d2078580a9eea0ca9368d1c99c097279b8081f88ac00000000\"</span>,\n  <span class=\"cm-string\">\"complete\"</span>: <span class=\"cm-atom\">true</span>\n}</span>\n</code></pre>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>\n&gt; <span class=\"cm-def\">SIGNED_RAW_TX</span><span class=\"cm-operator\">=</span>0100000001771078cb769f4a8fdb20c7a560a7b2e992e1d1[...]</span>\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-5-send-raw-transaction\"></div>5. Send raw transaction<a class=\"fa fa-anchor\" href=\"#section-5-send-raw-transaction\"></a></h1>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-5-a-second-transaction\"></div>5a. Second transaction<a class=\"fa fa-anchor\" href=\"#section-5-a-second-transaction\"></a></h2>\n<p>Attempt to broadcast the second transaction before we&#39;ve broadcast the first transaction.  The &lt;&lt;glossary:node&gt;&gt; rejects this attempt because the second transaction spends an &lt;&lt;glossary:output&gt;&gt; which is not a UTXO the node knows about.</p>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>&gt; dash-cli <span class=\"cm-attribute\">-regtest</span> sendrawtransaction <span class=\"cm-def\">$SIGNED_RAW_TX</span></span>\n</code></pre>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>error code: <span class=\"cm-attribute\">-25</span>\nerror message:\nMissing inputs\n\nerror: {<span class=\"cm-string\">\"code\"</span>:-22,<span class=\"cm-string\">\"message\"</span>:<span class=\"cm-string\">\"TX rejected\"</span>}</span>\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-5-b-first-transaction\"></div>5b. First transaction<a class=\"fa fa-anchor\" href=\"#section-5-b-first-transaction\"></a></h2>\n<p>Broadcast the first transaction, which succeeds, and then broadcast the second transaction---which also now succeeds because the node now sees the UTXO.</p>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>&gt; dash-cli <span class=\"cm-attribute\">-regtest</span> sendrawtransaction <span class=\"cm-def\">$OLD_SIGNED_RAW_TX</span>\n5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb781077\n&gt; dash-cli <span class=\"cm-attribute\">-regtest</span> sendrawtransaction <span class=\"cm-def\">$SIGNED_RAW_TX</span>\nf89deefb927fbd03c5acab194de2ba8f98ab160b9c4b3f57bde63073c4b5f060</span>\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-6-check-mempool\"></div>6. Check mempool<a class=\"fa fa-anchor\" href=\"#section-6-check-mempool\"></a></h1>\n<p>We have once again not generated an additional block, so the transactions above have not yet become part of the regtest block chain.  However, they are part of the local node&#39;s memory pool.</p>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>&gt; dash-cli <span class=\"cm-attribute\">-regtest</span> getrawmempool</span>\n</code></pre>\n<pre><code class=\"lang-json\"><span class='cm-s-neo'>[\n  <span class=\"cm-string\">\"f89deefb927fbd03c5acab194de2ba8f98ab160b9c4b3f57bde63073c4b5f060\"</span>,\n  <span class=\"cm-string\">\"5efd61cf24c9644d79646627c4d1e192e9b2a760a5c720db8f4a9f76cb781077\"</span>\n]</span>\n</code></pre>\n<p>Remove old shell variables.</p>\n<pre><code class=\"lang-bash\"><span class='cm-s-neo'>&gt; <span class=\"cm-keyword\">unset</span> OLD_SIGNED_RAW_TX SIGNED_RAW_TX RAW_TX [...]</span>\n</code></pre>\n\n</div>"
}