{
 "metadata": {
  "image": [],
  "title": "",
  "description": ""
 },
 "api": {
  "method": "get",
  "url": "",
  "auth": "required",
  "results": {
   "codes": [
    {
     "status": 200,
     "language": "json",
     "code": "{}",
     "name": ""
    },
    {
     "status": 400,
     "language": "json",
     "code": "{}",
     "name": ""
    }
   ]
  },
  "params": []
 },
 "next": {
  "description": "",
  "pages": []
 },
 "title": "Parsing A MerkleBlock",
 "updates": [],
 "type": "basic",
 "slug": "core-examples-p2p-network-parsing-a-merkleblock",
 "excerpt": "",
 "body": "In the section above, we retrieved a <<glossary:merkle block>> from the network; now we will parse it. Most of the <<glossary:block header>> has been omitted. For a more complete hexdump, see the example in the [`merkleblock` message section](core-ref-p2p-network-data-messages#section-merkleblock).\n\n``` text\n7f16c5962e8bd963659c793ce370d95f\n093bc7e367117b3c30c1f8fdd0d97287 ... Merkle root\n\n07000000 ........................... Transaction count: 7\n04 ................................. Hash count: 4\n\n3612262624047ee87660be1a707519a4\n43b1c1ce3d248cbfc6c15870f6c5daa2 ... Hash #1\n019f5b01d4195ecbc9398fbf3c3b1fa9\nbb3183301d7a1fb3bd174fcfa40a2b65 ... Hash #2\n41ed70551dd7e841883ab8f0b16bf041\n76b7d1480e4f0af9f3d4c3595768d068 ... Hash #3\n20d2a7bc994987302e5b1ac80fc425fe\n25f8b63169ea78e68fbaaefa59379bbf ... Hash #4\n\n01 ................................. Flag bytes: 1\n1d ................................. Flags: 1 0 1 1 1 0 0 0\n```\n\nWe parse the above [`merkleblock` message](core-ref-p2p-network-data-messages#section-merkleblock) using the following instructions.  Each illustration is described in the paragraph below it.\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-001.svg)\n\nWe start by building the structure of a <<glossary:merkle tree>> based on the number of <<glossary:transactions>> in the <<glossary:block>>.\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-002.svg)\n\nThe first flag is a 1 and the <<glossary:merkle root>> is (as always) a non-TXID node, so we will need to compute the hash later based on this node's children. Accordingly, we descend into the merkle root's left child and look at the next flag for instructions.\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-003.svg)\n\nThe next flag in the example is a 0 and this is also a non-TXID node, so we apply the first hash from the [`merkleblock` message](core-ref-p2p-network-data-messages#section-merkleblock) to this node. We also don't process any child nodes---according to the peer which created the [`merkleblock` message](core-ref-p2p-network-data-messages#section-merkleblock), none of those nodes will lead to <<glossary:TXIDs>> of transactions that match our filter, so we don't need them. We go back up to the merkle root and then descend into its right child and look at the next (third) flag for instructions.\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-004.svg)\n\nThe third flag in the example is another 1 on another non-TXID node, so we descend into its left child.\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-005.svg)\n\nThe fourth flag is also a 1 on another non-TXID node, so we descend again---we will always continue descending until we reach a TXID node or a non-TXID node with a 0 flag (or we finish filling out the tree).\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-006.svg)\n\nFinally, on the fifth flag in the example (a 1), we reach a TXID node. The 1 flag indicates this TXID's transaction matches our filter and that we should take the next (second) hash and use it as this node's TXID.\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-007.svg)\n\nThe sixth flag also applies to a TXID, but it's a 0 flag, so this TXID's transaction doesn't match our filter; still, we take the next (third) hash and use it as this node's TXID.\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-008.svg)\n\nWe now have enough information to compute the hash for the fourth node we encountered---it's the hash of the concatenated hashes of the two TXIDs we filled out.\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-009.svg)\n\nMoving to the right child of the third node we encountered, we fill it out using the seventh flag and final hash---and discover there are no more child nodes to process.\n\n![Parsing A MerkleBlock](https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-011.svg)\n\nWe hash as appropriate to fill out the tree.  Note that the eighth flag is not used---this is acceptable as it was required to pad out a flag byte.\n\nThe final steps would be to ensure the computed <<glossary:merkle root>> is identical to the merkle root in the <<glossary:header>> and check the other steps of the parsing checklist in the [`merkleblock` message](core-ref-p2p-network-data-messages#section-merkleblock) section.",
 "order": 4,
 "isReference": false,
 "hidden": false,
 "sync_unique": "",
 "link_url": "",
 "link_external": false,
 "pendingAlgoliaPublish": false,
 "createdAt": "2019-10-24T14:52:51.162Z",
 "updatedAt": "2019-11-11T22:04:01.266Z",
 "_id": "5e96055329a18c0025d39218",
 "version": "5e96055329a18c0025d39261",
 "project": "5daf2e65f4109c0040fd51e1",
 "parentDoc": "5e96055329a18c0025d3920f",
 "user": "5b8400d7185d5e00036dcc3b",
 "category": "5e96055329a18c0025d391e5",
 "__v": 0,
 "isApi": false,
 "id": "5e96055329a18c0025d39218",
 "body_html": "<div class=\"magic-block-textarea\"><p>In the section above, we retrieved a &lt;&lt;glossary:merkle block&gt;&gt; from the network; now we will parse it. Most of the &lt;&lt;glossary:block header&gt;&gt; has been omitted. For a more complete hexdump, see the example in the <a href=\"core-ref-p2p-network-data-messages#section-merkleblock\"><code>merkleblock</code> message section</a>.</p>\n<pre><code class=\"lang-text\">7f16c5962e8bd963659c793ce370d95f\n093bc7e367117b3c30c1f8fdd0d97287 ... Merkle root\n\n07000000 ........................... Transaction count: 7\n04 ................................. Hash count: 4\n\n3612262624047ee87660be1a707519a4\n43b1c1ce3d248cbfc6c15870f6c5daa2 ... Hash #1\n019f5b01d4195ecbc9398fbf3c3b1fa9\nbb3183301d7a1fb3bd174fcfa40a2b65 ... Hash #2\n41ed70551dd7e841883ab8f0b16bf041\n76b7d1480e4f0af9f3d4c3595768d068 ... Hash #3\n20d2a7bc994987302e5b1ac80fc425fe\n25f8b63169ea78e68fbaaefa59379bbf ... Hash #4\n\n01 ................................. Flag bytes: 1\n1d ................................. Flags: 1 0 1 1 1 0 0 0\n</code></pre>\n<p>We parse the above <a href=\"core-ref-p2p-network-data-messages#section-merkleblock\"><code>merkleblock</code> message</a> using the following instructions.  Each illustration is described in the paragraph below it.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-001.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>We start by building the structure of a &lt;&lt;glossary:merkle tree&gt;&gt; based on the number of &lt;&lt;glossary:transactions&gt;&gt; in the &lt;&lt;glossary:block&gt;&gt;.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-002.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>The first flag is a 1 and the &lt;&lt;glossary:merkle root&gt;&gt; is (as always) a non-TXID node, so we will need to compute the hash later based on this node&#39;s children. Accordingly, we descend into the merkle root&#39;s left child and look at the next flag for instructions.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-003.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>The next flag in the example is a 0 and this is also a non-TXID node, so we apply the first hash from the <a href=\"core-ref-p2p-network-data-messages#section-merkleblock\"><code>merkleblock</code> message</a> to this node. We also don&#39;t process any child nodes---according to the peer which created the <a href=\"core-ref-p2p-network-data-messages#section-merkleblock\"><code>merkleblock</code> message</a>, none of those nodes will lead to &lt;&lt;glossary:TXIDs&gt;&gt; of transactions that match our filter, so we don&#39;t need them. We go back up to the merkle root and then descend into its right child and look at the next (third) flag for instructions.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-004.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>The third flag in the example is another 1 on another non-TXID node, so we descend into its left child.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-005.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>The fourth flag is also a 1 on another non-TXID node, so we descend again---we will always continue descending until we reach a TXID node or a non-TXID node with a 0 flag (or we finish filling out the tree).</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-006.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>Finally, on the fifth flag in the example (a 1), we reach a TXID node. The 1 flag indicates this TXID&#39;s transaction matches our filter and that we should take the next (second) hash and use it as this node&#39;s TXID.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-007.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>The sixth flag also applies to a TXID, but it&#39;s a 0 flag, so this TXID&#39;s transaction doesn&#39;t match our filter; still, we take the next (third) hash and use it as this node&#39;s TXID.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-008.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>We now have enough information to compute the hash for the fourth node we encountered---it&#39;s the hash of the concatenated hashes of the two TXIDs we filled out.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-009.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>Moving to the right child of the third node we encountered, we fill it out using the seventh flag and final hash---and discover there are no more child nodes to process.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/gifs/en-merkleblock-parsing/en-merkleblock-parsing-011.svg\" alt=\"Parsing A MerkleBlock\"></p>\n<p>We hash as appropriate to fill out the tree.  Note that the eighth flag is not used---this is acceptable as it was required to pad out a flag byte.</p>\n<p>The final steps would be to ensure the computed &lt;&lt;glossary:merkle root&gt;&gt; is identical to the merkle root in the &lt;&lt;glossary:header&gt;&gt; and check the other steps of the parsing checklist in the <a href=\"core-ref-p2p-network-data-messages#section-merkleblock\"><code>merkleblock</code> message</a> section.</p>\n\n</div>"
}