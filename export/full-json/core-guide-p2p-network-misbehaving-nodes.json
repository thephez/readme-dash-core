{
 "_id": "5db349b7858496002bce20fd",
 "version": "5daf2e65f4109c0040fd51e5",
 "updatedAt": "2019-11-20T14:11:16.163Z",
 "createdAt": "2019-10-25T19:15:03.242Z",
 "project": "5daf2e65f4109c0040fd51e1",
 "user": "5b8400d7185d5e00036dcc3b",
 "parentDoc": "5db1ae38f84ce1006175ff9c",
 "category": "5db0a86967f978006336b1b5",
 "__v": 1,
 "updates": [],
 "next": {
  "pages": [
   {
    "category": "Core Guides",
    "slug": "core-guide-mining",
    "name": "Mining",
    "icon": "file-text-o",
    "type": "doc"
   }
  ],
  "description": ""
 },
 "link_external": false,
 "link_url": "",
 "sync_unique": "",
 "hidden": false,
 "api": {
  "results": {
   "codes": [
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 200
    },
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 400
    }
   ]
  },
  "auth": "required",
  "params": [],
  "url": "",
  "method": "get"
 },
 "isReference": false,
 "order": 5,
 "body": "Take note that for both types of broadcasting, mechanisms are in place to punish misbehaving <<glossary:peers>> who take up bandwidth and computing resources by sending false information. If a peer gets a banscore above the `-banscore=<n>` threshold (100 by default), they will be banned for the number of seconds defined by `-bantime=<n>`, which is 86,400 by default (24 hours).\n\n| Type | Misbehavior | Ban Score | Description |\n| ---- | ----------- | --------- | ----------- |\n| Net | GetBlockTxn Index Error | **100** | Peer relayed a [`getblocktxn` message](core-ref-p2p-network-data-messages#section-getblocktxn) with out-of-bound indices\n| Net | Bloom Filter Service | **100** | Bloom filter message received from peer that has bloom filter commands disabled by default (protocol version > 70201) (`filterload` message, [`filteradd` message](core-ref-p2p-network-control-messages#section-filteradd), or [`filterclear` message](core-ref-p2p-network-control-messages#section-filterclear))\n| Net | Block Rejected | 1 | Peer rejected the block it requested from us\n| Net | Duplicate Version | 1 | Duplicate [`version` message](core-ref-p2p-network-control-messages#section-version) received\n| Net | Wrong Devnet | **100** | Peer responded with the wrong devnet version (`version` message)\n| Net | Wrong Devnet | 1 | Peer connected using the wrong devnet version (`version` message)\n| Net | No Version | 1 | Received a message prior to receiving a [`version` message](core-ref-p2p-network-control-messages#section-version)\n| Net | No Verack | 1 | After sending [`version` message](core-ref-p2p-network-control-messages#section-version), received a message other than a [`verack` message](core-ref-p2p-network-control-messages#section-verack) back first\n| Net | Address List Size | 20 | More than 1000 addresses received (`addr` message)\n| Net | Inventory List | 20 | More than `MAX_INV_SZ` (50000) inventories received (`inv` message)\n| Net | Get Data Size | 20 | More than `MAX_INV_SZ` (50000) inventories requested (`getdata` message)\n| Net | Orphan Transaction | **Varies** | Peer relayed an invalid orphan transaction. Ban score varies from 0-100 based on the specific reason (values set by `AcceptToMemoryPoolWorker()`)\n| Net | Bad Transaction | **Varies** | Transaction rejected from the mempool\n| Net | Invalid Header | **Varies** | Invalid block header received from peer (`cmpctblock` message)\n| Net | Invalid CompactBlock | **100** | Invalid compact block /non-matching block transactions received from peer (`cmpctblock` message)\n| Net | Header List Size | 20 | More than `MAX_HEADERS_RESULTS` (2000) headers received (`headers` message)\n| Net | Header List Sequence | 20 | Non-continous headers sequence received (`headers` message)\n| Net | Invalid Block | **Varies** | Invalid block header received from peer\n| Net | Bloom Filter Size | **100** | Maximum script element size (520) exceeded (`filterload` message or [`filteradd` message](core-ref-p2p-network-control-messages#section-filteradd))\n| Net | MN List Diff | 1 | Failed to get masternode list diff (`getmnlistd` message)\n| Net | Unrequested MN List Diff | **100** | Peer provided an unrequested masternode list diff (`mnlistdiff` message)\n| InstantSend | Invalid Lock Message | **100** | Invalid TXID or inputs in lock message (`islock` message)\n| InstantSend | Verify Error | 20 | Peer relayed a message that failed to verify\n| LLMQ ChainLock | Invalid | 10 | Invalid ChainLock message (`clsig` message)\n| LLMQ Commitment | Null QcTx | **100** | Peer relayed a block with a null commitment\n| LLMQ Commitment | Invalid LLMQ Type | **100** | Peer relayed a block containing an invalid LLMQ Type\n| LLMQ Commitment | Invalid Height | **100** | Peer relayed a block that is not the first block in the DKG interval\n| LLMQ Commitment | Invalid Commitment | **100** | Peer relayed a block with an invalid quorum commitment\n| LLMQ DKG | Empty Message | **100** | Peer relayed a message with no payload\n| LLMQ DKG | Invalid LLMQ Type | **100** | Peer relayed a message for an incorrect LLMQ Type\n| LLMQ DKG | Invalid Message | **100** | Peer relayed a message that could not be deserialized\n| LLMQ DKG | Preverify Failed | **100** | Peer relayed a message that could not be pre-verified\n| LLMQ DKG | Signature  | **100** | Peer relayed a message with an invalid signature\n| LLMQ DKG | Full Verify Failed | **100** | Peer relayed a message that failed full verification\n| LLMQ Signing | Too Many Messages | **100** | Maximum message count exceed in [`qsigsesann` message](core-ref-p2p-network-quorum-messages#section-qsigsesann), [`qsigsinv` message](core-ref-p2p-network-quorum-messages#section-qsigsinv), [`qgetsigs` message](core-ref-p2p-network-quorum-messages#section-qgetsigs), or [`qbsigs` message](core-ref-p2p-network-quorum-messages#section-qbsigs)\n| LLMQ Signing | Signature  | **100** | Peer relayed a message with an invalid recovered signature or signature share\n| Masternode Authentication | Duplicate Message | **100** | Only 1 message allowed (`mnauth` message)\n| Masternode Authentication | Signature | **100** | Peer relayed a message with an invalid signature (`mnauth` message)\n| Masternode Authentication | Invalid MN | 10 | Peer not in the valid masternode list (`mnauth` message)\n| Governance | Sync | 20 | Requesting a governance sync too frequently (`govsync` message with empty hash)\n| Governance | Invalid Object | 20 | Peer relayed an invalid governance object (`govobj` message)\n| Governance | Invalid Vote | 20 | Peer relayed an invalid/invalid old vote(`govobjvote` message)\n| Governance | Unsupported Vote Signal | 20 | Vote signal outside the accepted range (see [`govobjvote` message](core-ref-p2p-network-governance-messages#section-govobjvote))\n| PrivateSend | Signature  | 10 | Peer relayed a message with an invalid signature (`dsq` message)\n| Spork | Invalid Time | **100** | Peer relayed a spork with a timestamp too far in the future (`spork` message)\n| Spork | Signature  | **100** | Peer relayed a spork with an invalid signature (`spork` message)",
 "excerpt": "",
 "slug": "core-guide-p2p-network-misbehaving-nodes",
 "type": "basic",
 "metadata": {
  "description": "",
  "title": "",
  "image": []
 },
 "title": "Misbehaving Nodes",
 "id": "5db349b7858496002bce20fd",
 "isApi": false,
 "body_html": "<div class=\"magic-block-textarea\"><p>Take note that for both types of broadcasting, mechanisms are in place to punish misbehaving &lt;&lt;glossary:peers&gt;&gt; who take up bandwidth and computing resources by sending false information. If a peer gets a banscore above the <code>-banscore=&lt;n&gt;</code> threshold (100 by default), they will be banned for the number of seconds defined by <code>-bantime=&lt;n&gt;</code>, which is 86,400 by default (24 hours).</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Type</th>\n<th>Misbehavior</th>\n<th>Ban Score</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Net</td>\n<td>GetBlockTxn Index Error</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a <a href=\"core-ref-p2p-network-data-messages#section-getblocktxn\"><code>getblocktxn</code> message</a> with out-of-bound indices</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Bloom Filter Service</td>\n<td><strong>100</strong></td>\n<td>Bloom filter message received from peer that has bloom filter commands disabled by default (protocol version &gt; 70201) (<code>filterload</code> message, <a href=\"core-ref-p2p-network-control-messages#section-filteradd\"><code>filteradd</code> message</a>, or <a href=\"core-ref-p2p-network-control-messages#section-filterclear\"><code>filterclear</code> message</a>)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Block Rejected</td>\n<td>1</td>\n<td>Peer rejected the block it requested from us</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Duplicate Version</td>\n<td>1</td>\n<td>Duplicate <a href=\"core-ref-p2p-network-control-messages#section-version\"><code>version</code> message</a> received</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Wrong Devnet</td>\n<td><strong>100</strong></td>\n<td>Peer responded with the wrong devnet version (<code>version</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Wrong Devnet</td>\n<td>1</td>\n<td>Peer connected using the wrong devnet version (<code>version</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>No Version</td>\n<td>1</td>\n<td>Received a message prior to receiving a <a href=\"core-ref-p2p-network-control-messages#section-version\"><code>version</code> message</a></td>\n</tr>\n<tr>\n<td>Net</td>\n<td>No Verack</td>\n<td>1</td>\n<td>After sending <a href=\"core-ref-p2p-network-control-messages#section-version\"><code>version</code> message</a>, received a message other than a <a href=\"core-ref-p2p-network-control-messages#section-verack\"><code>verack</code> message</a> back first</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Address List Size</td>\n<td>20</td>\n<td>More than 1000 addresses received (<code>addr</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Inventory List</td>\n<td>20</td>\n<td>More than <code>MAX_INV_SZ</code> (50000) inventories received (<code>inv</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Get Data Size</td>\n<td>20</td>\n<td>More than <code>MAX_INV_SZ</code> (50000) inventories requested (<code>getdata</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Orphan Transaction</td>\n<td><strong>Varies</strong></td>\n<td>Peer relayed an invalid orphan transaction. Ban score varies from 0-100 based on the specific reason (values set by <code>AcceptToMemoryPoolWorker()</code>)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Bad Transaction</td>\n<td><strong>Varies</strong></td>\n<td>Transaction rejected from the mempool</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Invalid Header</td>\n<td><strong>Varies</strong></td>\n<td>Invalid block header received from peer (<code>cmpctblock</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Invalid CompactBlock</td>\n<td><strong>100</strong></td>\n<td>Invalid compact block /non-matching block transactions received from peer (<code>cmpctblock</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Header List Size</td>\n<td>20</td>\n<td>More than <code>MAX_HEADERS_RESULTS</code> (2000) headers received (<code>headers</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Header List Sequence</td>\n<td>20</td>\n<td>Non-continous headers sequence received (<code>headers</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Invalid Block</td>\n<td><strong>Varies</strong></td>\n<td>Invalid block header received from peer</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Bloom Filter Size</td>\n<td><strong>100</strong></td>\n<td>Maximum script element size (520) exceeded (<code>filterload</code> message or <a href=\"core-ref-p2p-network-control-messages#section-filteradd\"><code>filteradd</code> message</a>)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>MN List Diff</td>\n<td>1</td>\n<td>Failed to get masternode list diff (<code>getmnlistd</code> message)</td>\n</tr>\n<tr>\n<td>Net</td>\n<td>Unrequested MN List Diff</td>\n<td><strong>100</strong></td>\n<td>Peer provided an unrequested masternode list diff (<code>mnlistdiff</code> message)</td>\n</tr>\n<tr>\n<td>InstantSend</td>\n<td>Invalid Lock Message</td>\n<td><strong>100</strong></td>\n<td>Invalid TXID or inputs in lock message (<code>islock</code> message)</td>\n</tr>\n<tr>\n<td>InstantSend</td>\n<td>Verify Error</td>\n<td>20</td>\n<td>Peer relayed a message that failed to verify</td>\n</tr>\n<tr>\n<td>LLMQ ChainLock</td>\n<td>Invalid</td>\n<td>10</td>\n<td>Invalid ChainLock message (<code>clsig</code> message)</td>\n</tr>\n<tr>\n<td>LLMQ Commitment</td>\n<td>Null QcTx</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a block with a null commitment</td>\n</tr>\n<tr>\n<td>LLMQ Commitment</td>\n<td>Invalid LLMQ Type</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a block containing an invalid LLMQ Type</td>\n</tr>\n<tr>\n<td>LLMQ Commitment</td>\n<td>Invalid Height</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a block that is not the first block in the DKG interval</td>\n</tr>\n<tr>\n<td>LLMQ Commitment</td>\n<td>Invalid Commitment</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a block with an invalid quorum commitment</td>\n</tr>\n<tr>\n<td>LLMQ DKG</td>\n<td>Empty Message</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a message with no payload</td>\n</tr>\n<tr>\n<td>LLMQ DKG</td>\n<td>Invalid LLMQ Type</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a message for an incorrect LLMQ Type</td>\n</tr>\n<tr>\n<td>LLMQ DKG</td>\n<td>Invalid Message</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a message that could not be deserialized</td>\n</tr>\n<tr>\n<td>LLMQ DKG</td>\n<td>Preverify Failed</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a message that could not be pre-verified</td>\n</tr>\n<tr>\n<td>LLMQ DKG</td>\n<td>Signature</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a message with an invalid signature</td>\n</tr>\n<tr>\n<td>LLMQ DKG</td>\n<td>Full Verify Failed</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a message that failed full verification</td>\n</tr>\n<tr>\n<td>LLMQ Signing</td>\n<td>Too Many Messages</td>\n<td><strong>100</strong></td>\n<td>Maximum message count exceed in <a href=\"core-ref-p2p-network-quorum-messages#section-qsigsesann\"><code>qsigsesann</code> message</a>, <a href=\"core-ref-p2p-network-quorum-messages#section-qsigsinv\"><code>qsigsinv</code> message</a>, <a href=\"core-ref-p2p-network-quorum-messages#section-qgetsigs\"><code>qgetsigs</code> message</a>, or <a href=\"core-ref-p2p-network-quorum-messages#section-qbsigs\"><code>qbsigs</code> message</a></td>\n</tr>\n<tr>\n<td>LLMQ Signing</td>\n<td>Signature</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a message with an invalid recovered signature or signature share</td>\n</tr>\n<tr>\n<td>Masternode Authentication</td>\n<td>Duplicate Message</td>\n<td><strong>100</strong></td>\n<td>Only 1 message allowed (<code>mnauth</code> message)</td>\n</tr>\n<tr>\n<td>Masternode Authentication</td>\n<td>Signature</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a message with an invalid signature (<code>mnauth</code> message)</td>\n</tr>\n<tr>\n<td>Masternode Authentication</td>\n<td>Invalid MN</td>\n<td>10</td>\n<td>Peer not in the valid masternode list (<code>mnauth</code> message)</td>\n</tr>\n<tr>\n<td>Governance</td>\n<td>Sync</td>\n<td>20</td>\n<td>Requesting a governance sync too frequently (<code>govsync</code> message with empty hash)</td>\n</tr>\n<tr>\n<td>Governance</td>\n<td>Invalid Object</td>\n<td>20</td>\n<td>Peer relayed an invalid governance object (<code>govobj</code> message)</td>\n</tr>\n<tr>\n<td>Governance</td>\n<td>Invalid Vote</td>\n<td>20</td>\n<td>Peer relayed an invalid/invalid old vote(<code>govobjvote</code> message)</td>\n</tr>\n<tr>\n<td>Governance</td>\n<td>Unsupported Vote Signal</td>\n<td>20</td>\n<td>Vote signal outside the accepted range (see <a href=\"core-ref-p2p-network-governance-messages#section-govobjvote\"><code>govobjvote</code> message</a>)</td>\n</tr>\n<tr>\n<td>PrivateSend</td>\n<td>Signature</td>\n<td>10</td>\n<td>Peer relayed a message with an invalid signature (<code>dsq</code> message)</td>\n</tr>\n<tr>\n<td>Spork</td>\n<td>Invalid Time</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a spork with a timestamp too far in the future (<code>spork</code> message)</td>\n</tr>\n<tr>\n<td>Spork</td>\n<td>Signature</td>\n<td><strong>100</strong></td>\n<td>Peer relayed a spork with an invalid signature (<code>spork</code> message)</td>\n</tr>\n</tbody>\n</table></div>\n\n</div>"
}