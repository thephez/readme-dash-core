{
 "_id": "5db0b031f419d900281517d3",
 "version": "5daf2e65f4109c0040fd51e5",
 "project": "5daf2e65f4109c0040fd51e1",
 "user": "5b8400d7185d5e00036dcc3b",
 "parentDoc": "5db0a910c4e022001110a32e",
 "category": "5db0a86967f978006336b1b5",
 "__v": 1,
 "updates": [],
 "updatedAt": "2019-11-12T19:56:42.920Z",
 "createdAt": "2019-10-23T19:55:29.974Z",
 "next": {
  "pages": [
   {
    "category": "Core Guides",
    "slug": "core-guide-block-chain",
    "name": "Block Chain",
    "icon": "file-text-o",
    "type": "doc"
   }
  ],
  "description": ""
 },
 "link_external": false,
 "link_url": "",
 "sync_unique": "",
 "hidden": false,
 "api": {
  "results": {
   "codes": [
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 200
    },
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 400
    }
   ]
  },
  "auth": "required",
  "params": [],
  "url": "",
  "method": "get"
 },
 "isReference": false,
 "order": 8,
 "body": "[block:callout]\n{\n  \"type\": \"danger\",\n  \"body\": \"**The following information is deprecated and for historical reference only. It describes features that have been redesigned and no longer operate as described below.**\",\n  \"title\": \"Deprecated Content\"\n}\n[/block]\n# InstantSend (original)\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"**Please see [here for details of the current InstantSend design](core-guide-dash-features-instantsend).**\"\n}\n[/block]\nDash Core's InstantSend feature provides a way to lock transaction inputs and enable secure, instantaneous transactions. Since Dash Core 0.13.0, any qualifying transaction is automatically upgraded to InstantSend by the network without a need for the sending wallet to explicitly request it. For these simple transactions (those containing 4 or fewer inputs), the previous requirement for a special InstantSend transaction fee was also removed. The criteria for determining eligibility can be found in the lists of limitations below.\n\nThe following video provides an overview with a good introduction to the details including the InstantSend vulnerability that was fixed in Dash Core 0.12.2. Some specific points in the video are listed here for quick reference:\n\n - 2:00 - InstantSend restrictions\n - 5:00 - Masternode quorum creation\n - 6:00 - Input locking\n - 7:45 - Quorum score calculation / Requirement for block confirmations\n - 9:00 - Description of Dash Core pre-0.12.2 InstantSend vulnerability\n - 13:00 - Description of vulnerability fix / Post Dash Core 0.12.2 operation\n\n[block:embed]\n{\n  \"html\": false,\n  \"url\": \"https://www.youtube-nocookie.com/embed/n4PELomRiFY?rel=0;start=0\",\n  \"title\": \"Matt Robertson - Instant Send - The Dash Conference - YouTube\",\n  \"favicon\": \"https://www.youtube-nocookie.com/favicon.ico\",\n  \"iframe\": true,\n  \"width\": \"\",\n  \"height\": \"\"\n}\n[/block]\n*InstantSend Data Flow*\n\n| **InstantSend Client** | **Direction**  | **Peers**   | **Description** |\n| --- | :---: | --- | --- |\n| [`inv` message](core-ref-p2p-network-data-messages#section-inv) (ix)          | \u2192 |                         | Client sends inventory for transaction lock request\n|                             | \u2190 | [`getdata` message](core-ref-p2p-network-data-messages#section-getdata) (ix)  | Peer responds with request for transaction lock request\n| `ix` message                | \u2192 |                         | Client sends InstantSend transaction lock request\n|                             | \u2190 | [`inv` message](core-ref-p2p-network-data-messages#section-inv) (txlvote) | Masternodes in the [quorum](core-guide-dash-features-masternode-quorums#section-quorum-selection) respond with votes\n| [`getdata` message](core-ref-p2p-network-data-messages#section-getdata) (txlvote) | \u2192 |                         | Client requests vote\n|                             | \u2190 | `txlvote` message       | Peer responds with vote\n\nOnce an InstantSend lock has been requested, the `instantsend` field of various RPCs (e.g. the [`getmempoolentry` RPC](core-api-ref-remote-procedure-calls-blockchain#section-getmempoolentry)) is set to `true`. Then, if a sufficient number of votes approve the transaction lock, the InstantSend transaction is approved the `instantlock` field of the RPC is set to `true`.\n\nIf an InstantSend transaction is a valid transaction but does not receive a transaction lock, it reverts to being a standard transaction.\n\nThere are a number of limitations on InstantSend transactions:\n\n* The lock request will timeout 15 seconds after the first vote is seen (`INSTANTSEND_LOCK_TIMEOUT_SECONDS`)\n* The lock request will fail if it has not been locked after 60 seconds (`INSTANTSEND_FAILED_TIMEOUT_SECONDS`)\n* A \u201cper-input\u201d fee of 0.0001 DASH per input is required for non-simple transactions (inputs >=5) since they place a higher load on the masternodes. This fee was most recently decreased by [DIP-0001](https://github.com/dashpay/dips/blob/master/dip-0001.md).\n* To be used in an InstantSend transaction, an input must have at least the number confirmations (block depth) indicated by the table below\n\n| **Network** | **Confirmations Required** |\n| --- | --- |\n| Mainnet | 6 Blocks |\n| Testnet | 2 Blocks |\n| Regtest | 2 Blocks |\n| Devnet  | 2 Blocks |\n\nThere are some further limitations on Automatic InstantSend transactions:\n\n* DIP3 must be active\n* Spork 16 must be enabled\n* Mempool usage must be lower than 10% (`AUTO_IX_MEMPOOL_THRESHOLD`). As of Dash Core 0.13.0, this corresponds to a mempool size of 30 MB (`DEFAULT_MAX_MEMPOOL_SIZE` = 300 MB).\n\n**Historical Note**\n\nPrior to Dash Core 0.13.0, `instantsend` and `instantlock` values were not available via RPC. At that time, the InstantSend system worked as described below.\n\nOnce a sufficient number of votes approved the transaction lock, the InstantSend transaction was approved and showed 5 confirmations (`DEFAULT_INSTANTSEND_DEPTH`).\n\nNOTE: The 5 \"pseudo-confirmations\" were shown to convey confidence that the transaction was secure from double-spending and DID NOT indicate the transaction had already been confirmed to a block depth of 5 in the blockchain.\n\n# Masternode Payment (original)\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"**The following information is for historical reference only. It describes the masternode payment process that was used prior to the deterministic masternode list update in Dash Core v0.13 that implemented DIP3.**\\n\\nPlease see [here for details of the current system](core-guide-dash-features-masternode-payment)\"\n}\n[/block]\n\nPrior to DIP3, the masternode payment process operated as described below.\n\nMasternode payment uses a verifiable process to determine which masternode is paid in each block. When a new block is processed, a quorum of `MNPAYMENTS_SIGNATURES_TOTAL` (10) masternodes vote on the next masternode payee. The quorum is calculated deterministically based on the distance between masternode's hash and the block's proof of work.\n\nEach member of the quorum issues a 'mnw' message that is relayed to the network. The payee is selected from a subset of masternodes made up of 10% of eligible nodes that have been waiting the longest since their last payment. The winner is then determined based on a number of parameters including the distance between the its hash and the block's proof of work. For additional detail, reference this [Official Documentation Payment Logic page](https://docs.dash.org/en/0.12.3/masternodes/understanding.html#payment-logic).\n\nNodes receiving a `mnw` message verify the validity of the message before relaying it to their peers. If the message is invalid, the sending node may be treated as misbehaving and have its ban score increased.\n\n# Masternode Sync (original)\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"**The following information is for historical reference only. It describes the masternode sync process that was used prior to the deterministic masternode list update in Dash Core v0.13 that implemented DIP3.**\\n\\nPlease see [here for details of the current system](core-guide-dash-features-masternode-sync)\"\n}\n[/block]\n## Initial Sync\n\nThis diagram shows the order in which P2P messages are sent to perform masternode synchronization initially after startup.\n\n![Masternode Sync (Initial)](https://dash-docs.github.io/img/dev/en-masternode-sync-initial.svg)\n\nThe following table details the data flow of P2P messages exchanged during initial masternode synchronization before the activation of DIP3 and Spork 15.\n\n| **Syncing Node Message** | **Direction**  | **Masternode Response**   | **Description** |\n| --- | :---: | --- | --- |\n| **1. Sporks** |   |  |  |\n| [`getsporks` message](core-ref-p2p-network-control-messages#section-getsporks)                            | \u2192 |                           | Syncing node requests sporks\n|                                                | \u2190 | [`spork` message](core-ref-p2p-network-control-messages#section-spork)(s)        |\n| **2. Masternode List** |   |  | Sync Masternode list from other connected clients |\n| `dseg` message                                 | \u2192 |                           | Syncing node requests masternode list\n|                                                | \u2190 | [`ssc` message](core-ref-p2p-network-masternode-messages#section-ssc) | Number of entries in masternode list (MASTERNODE_SYNC_LIST)<br><br>Only sent if requesting entire list\n|                                                | \u2190 | [`inv` message](core-ref-p2p-network-data-messages#section-inv)(s) (mnb)         | MSG_MASTERNODE_ANNOUNCE\n|                                                | \u2190 | [`inv` message](core-ref-p2p-network-data-messages#section-inv)(s) (mnp)         | MSG_MASTERNODE_PING\n| [`getdata` message](core-ref-p2p-network-data-messages#section-getdata)(s) (mnb) | \u2192 |                           | (Optional)\n| [`getdata` message](core-ref-p2p-network-data-messages#section-getdata)(s) (mnp)     | \u2192 |                           | (Optional)\n|                                                | \u2190 | `mnb` message(s)          | (If requested) Masternode announce message\n|                                                | \u2190 | `mnp` message(s)          | (If requested) Masternode ping message\n| **3. Masternode payments** |   |  | Ask node for all payment votes it has (new nodes will only return votes for future payments) |\n| `mnget` message                                | \u2192 |                           | Syncing node requests masternode payment sync\n|                                                | \u2190 | [`ssc` message](core-ref-p2p-network-masternode-messages#section-ssc) | Number of entries in masternode payment list\n|                                                | \u2190 | [`inv` message](core-ref-p2p-network-data-messages#section-inv)(s) (mnw)         | MSG_MASTERNODE_PAYMENT_VOTE\n| [`getdata` message](core-ref-p2p-network-data-messages#section-getdata)(s) (mnw) | \u2192 |                           | (Optional)\n|                                                | \u2190 | `mnw` message(s)          | (If requested) Masternode payment vote message\n| **4. Governance** |   |  | See [Governance sync](core-guide-dash-features-governance) |\n\n## Ongoing Sync\n\nOnce a masternode completes an initial full sync, continuing synchronization is maintained by the exchange of P2P messages with other nodes. This diagram shows an overview of the messages exchanged to keep the masternode list, masternode payments, and governance objects synchronized between masternodes.\n\n![Masternode Sync (Ongoing)](https://dash-docs.github.io/img/dev/en-masternode-sync-ongoing.svg)\n\n**Recurring Ping**\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"Note: Deprecated following activation of DIP3.\"\n}\n[/block]\nEach masternode issues a ping (`mnp` message) periodically to notify the network that it is still online. Masternodes that do not issue a ping for 3 hours will be put into the `MASTERNODE_NEW_START_REQUIRED` state and will need to issue a masternode announce (`mnb` message).\n\n**Masternode List**\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"Note: Deprecated following activation of DIP3.\"\n}\n[/block]\nAfter the initial masternode list has been received, it is kept current by a combination of the periodic `mnp` messages received from other masternodes, the `mnb` messages sent by masternodes as they come online, and `mnv` messages to verify that other masternodes are valid.\n\nAlso, `dseg` messages can be sent to request masternode info when messages are received that have been signed by an unrecognized masternode (most masternode/governance messages include a `vin` value that can be used to verify the masternode's unspent 1000 Dash).\n\nUnsynchronized peers may send a `dseg` message to request the entire masternode list.\n\n**Masternode Payment**\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"Note: Deprecated following activation of DIP3.\"\n}\n[/block]\nAfter the initial masternode payment synchronization, payment information is kept current via the `mnw` messages relayed on the network. Unsynchronized peers may send a `mnget` message to request masternode payment sync.\n\n## Sync Schedule\n\nPrior to the deterministic masternode system introduced by DIP3 in Dash Core 0.13, the following additional sync actions were also required.\n\n| **Period (seconds)** | **Action** | **Description** |\n| --- | --- | --- |\n| 1   | MN Check                  | ![Warning icon](https://dash-docs.github.io/img/icons/icon_warning.svg) _Deprecated following activation of DIP3 and Spork 15_<br><br>Check the state of each masternode that is still funded and not banned. The action occurs once per second, but individual masternodes are only checked at most every 5 seconds (only a subset of masternodes are checked each time it runs) (masternodeman.cpp) |\n| 60  | MN Check/Remove           | ![Warning icon](https://dash-docs.github.io/img/icons/icon_warning.svg) _Deprecated following activation of DIP3 and Spork 15_<br><br>Remove spent masternodes and check the state of inactive ones (masternodeman.cpp) |\n| 60  | MN Payment Check/Remove   | ![Warning icon](https://dash-docs.github.io/img/icons/icon_warning.svg) _Deprecated following activation of DIP3 and Spork 15_<br><br>Remove old masternode payment votes/blocks (masternode-payments.cpp) |\n| 300 | Full verification         | ![Warning icon](https://dash-docs.github.io/img/icons/icon_warning.svg) _Deprecated following activation of DIP3 and Spork 15_<br><br>Verify masternodes via direct requests (`mnv` messages - note time constraints in the Developer Reference section) (masternodeman.cpp) |\n| 600 | Manage State              | ![Warning icon](https://dash-docs.github.io/img/icons/icon_warning.svg) _Deprecated following activation of DIP3 and Spork 15_<br><br>Sends masternode pings (`mnp` message). Also sends initial masternode broadcast (`mnb` message) for local masternodes. (activemasternode.cpp) |",
 "excerpt": "",
 "slug": "core-guide-dash-features-historical-reference",
 "type": "basic",
 "metadata": {
  "description": "",
  "title": "",
  "image": []
 },
 "title": "Historical Reference",
 "id": "5db0b031f419d900281517d3",
 "isApi": false,
 "body_html": "<div class=\"magic-block-callout type-danger \">\n\t<h3><i title=\"Danger\" class=\"fa fa-exclamation-triangle\"></i>Deprecated Content\n\t</h3>\n\t<div class=\"callout-body\"><p><strong>The following information is deprecated and for historical reference only. It describes features that have been redesigned and no longer operate as described below.</strong></p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-instantsend-original-\"></div>InstantSend (original)<a class=\"fa fa-anchor\" href=\"#section-instantsend-original-\"></a></h1>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p><strong>Please see <a href=\"core-guide-dash-features-instantsend\">here for details of the current InstantSend design</a>.</strong></p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>Dash Core&#39;s InstantSend feature provides a way to lock transaction inputs and enable secure, instantaneous transactions. Since Dash Core 0.13.0, any qualifying transaction is automatically upgraded to InstantSend by the network without a need for the sending wallet to explicitly request it. For these simple transactions (those containing 4 or fewer inputs), the previous requirement for a special InstantSend transaction fee was also removed. The criteria for determining eligibility can be found in the lists of limitations below.</p>\n<p>The following video provides an overview with a good introduction to the details including the InstantSend vulnerability that was fixed in Dash Core 0.12.2. Some specific points in the video are listed here for quick reference:</p>\n<ul>\n<li >2:00 - InstantSend restrictions</li><li >5:00 - Masternode quorum creation</li><li >6:00 - Input locking</li><li >7:45 - Quorum score calculation / Requirement for block confirmations</li><li >9:00 - Description of Dash Core pre-0.12.2 InstantSend vulnerability</li><li >13:00 - Description of vulnerability fix / Post Dash Core 0.12.2 operation</li></ul>\n\n</div>\n<div class=\"magic-block-embed\">\n\t<iframe src=\"https://www.youtube-nocookie.com/embed/n4PELomRiFY?rel=0;start=0\" width=\"100%\" height=\"300px\" class=\"media-iframe\"></iframe>\n</div>\n<div class=\"magic-block-textarea\"><p><em>InstantSend Data Flow</em></p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th><strong>InstantSend Client</strong></th>\n<th style=\"text-align:center\"><strong>Direction</strong></th>\n<th><strong>Peers</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"core-ref-p2p-network-data-messages#section-inv\"><code>inv</code> message</a> (ix)</td>\n<td style=\"text-align:center\">\u2192</td>\n<td></td>\n<td>Client sends inventory for transaction lock request</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><a href=\"core-ref-p2p-network-data-messages#section-getdata\"><code>getdata</code> message</a> (ix)</td>\n<td>Peer responds with request for transaction lock request</td>\n</tr>\n<tr>\n<td><code>ix</code> message</td>\n<td style=\"text-align:center\">\u2192</td>\n<td></td>\n<td>Client sends InstantSend transaction lock request</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><a href=\"core-ref-p2p-network-data-messages#section-inv\"><code>inv</code> message</a> (txlvote)</td>\n<td>Masternodes in the <a href=\"core-guide-dash-features-masternode-quorums#section-quorum-selection\">quorum</a> respond with votes</td>\n</tr>\n<tr>\n<td><a href=\"core-ref-p2p-network-data-messages#section-getdata\"><code>getdata</code> message</a> (txlvote)</td>\n<td style=\"text-align:center\">\u2192</td>\n<td></td>\n<td>Client requests vote</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><code>txlvote</code> message</td>\n<td>Peer responds with vote</td>\n</tr>\n</tbody>\n</table></div>\n<p>Once an InstantSend lock has been requested, the <code>instantsend</code> field of various RPCs (e.g. the <a href=\"core-api-ref-remote-procedure-calls-blockchain#section-getmempoolentry\"><code>getmempoolentry</code> RPC</a>) is set to <code>true</code>. Then, if a sufficient number of votes approve the transaction lock, the InstantSend transaction is approved the <code>instantlock</code> field of the RPC is set to <code>true</code>.</p>\n<p>If an InstantSend transaction is a valid transaction but does not receive a transaction lock, it reverts to being a standard transaction.</p>\n<p>There are a number of limitations on InstantSend transactions:</p>\n<ul>\n<li >The lock request will timeout 15 seconds after the first vote is seen (<code>INSTANTSEND_LOCK_TIMEOUT_SECONDS</code>)</li><li >The lock request will fail if it has not been locked after 60 seconds (<code>INSTANTSEND_FAILED_TIMEOUT_SECONDS</code>)</li><li >A \u201cper-input\u201d fee of 0.0001 DASH per input is required for non-simple transactions (inputs &gt;=5) since they place a higher load on the masternodes. This fee was most recently decreased by <a href=\"https://github.com/dashpay/dips/blob/master/dip-0001.md\">DIP-0001</a>.</li><li >To be used in an InstantSend transaction, an input must have at least the number confirmations (block depth) indicated by the table below</li></ul>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th><strong>Network</strong></th>\n<th><strong>Confirmations Required</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Mainnet</td>\n<td>6 Blocks</td>\n</tr>\n<tr>\n<td>Testnet</td>\n<td>2 Blocks</td>\n</tr>\n<tr>\n<td>Regtest</td>\n<td>2 Blocks</td>\n</tr>\n<tr>\n<td>Devnet</td>\n<td>2 Blocks</td>\n</tr>\n</tbody>\n</table></div>\n<p>There are some further limitations on Automatic InstantSend transactions:</p>\n<ul>\n<li >DIP3 must be active</li><li >Spork 16 must be enabled</li><li >Mempool usage must be lower than 10% (<code>AUTO_IX_MEMPOOL_THRESHOLD</code>). As of Dash Core 0.13.0, this corresponds to a mempool size of 30 MB (<code>DEFAULT_MAX_MEMPOOL_SIZE</code> = 300 MB).</li></ul>\n<p><strong>Historical Note</strong></p>\n<p>Prior to Dash Core 0.13.0, <code>instantsend</code> and <code>instantlock</code> values were not available via RPC. At that time, the InstantSend system worked as described below.</p>\n<p>Once a sufficient number of votes approved the transaction lock, the InstantSend transaction was approved and showed 5 confirmations (<code>DEFAULT_INSTANTSEND_DEPTH</code>).</p>\n<p>NOTE: The 5 &quot;pseudo-confirmations&quot; were shown to convey confidence that the transaction was secure from double-spending and DID NOT indicate the transaction had already been confirmed to a block depth of 5 in the blockchain.</p>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-masternode-payment-original-\"></div>Masternode Payment (original)<a class=\"fa fa-anchor\" href=\"#section-masternode-payment-original-\"></a></h1>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p><strong>The following information is for historical reference only. It describes the masternode payment process that was used prior to the deterministic masternode list update in Dash Core v0.13 that implemented DIP3.</strong></p>\n<p>Please see <a href=\"core-guide-dash-features-masternode-payment\">here for details of the current system</a></p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>Prior to DIP3, the masternode payment process operated as described below.</p>\n<p>Masternode payment uses a verifiable process to determine which masternode is paid in each block. When a new block is processed, a quorum of <code>MNPAYMENTS_SIGNATURES_TOTAL</code> (10) masternodes vote on the next masternode payee. The quorum is calculated deterministically based on the distance between masternode&#39;s hash and the block&#39;s proof of work.</p>\n<p>Each member of the quorum issues a &#39;mnw&#39; message that is relayed to the network. The payee is selected from a subset of masternodes made up of 10% of eligible nodes that have been waiting the longest since their last payment. The winner is then determined based on a number of parameters including the distance between the its hash and the block&#39;s proof of work. For additional detail, reference this <a href=\"https://docs.dash.org/en/0.12.3/masternodes/understanding.html#payment-logic\">Official Documentation Payment Logic page</a>.</p>\n<p>Nodes receiving a <code>mnw</code> message verify the validity of the message before relaying it to their peers. If the message is invalid, the sending node may be treated as misbehaving and have its ban score increased.</p>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-masternode-sync-original-\"></div>Masternode Sync (original)<a class=\"fa fa-anchor\" href=\"#section-masternode-sync-original-\"></a></h1>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p><strong>The following information is for historical reference only. It describes the masternode sync process that was used prior to the deterministic masternode list update in Dash Core v0.13 that implemented DIP3.</strong></p>\n<p>Please see <a href=\"core-guide-dash-features-masternode-sync\">here for details of the current system</a></p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-initial-sync\"></div>Initial Sync<a class=\"fa fa-anchor\" href=\"#section-initial-sync\"></a></h2>\n<p>This diagram shows the order in which P2P messages are sent to perform masternode synchronization initially after startup.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/en-masternode-sync-initial.svg\" alt=\"Masternode Sync (Initial)\"></p>\n<p>The following table details the data flow of P2P messages exchanged during initial masternode synchronization before the activation of DIP3 and Spork 15.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th><strong>Syncing Node Message</strong></th>\n<th style=\"text-align:center\"><strong>Direction</strong></th>\n<th><strong>Masternode Response</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>1. Sporks</strong></td>\n<td style=\"text-align:center\"></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"core-ref-p2p-network-control-messages#section-getsporks\"><code>getsporks</code> message</a></td>\n<td style=\"text-align:center\">\u2192</td>\n<td></td>\n<td>Syncing node requests sporks</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><a href=\"core-ref-p2p-network-control-messages#section-spork\"><code>spork</code> message</a>(s)</td>\n</tr>\n<tr>\n<td><strong>2. Masternode List</strong></td>\n<td style=\"text-align:center\"></td>\n<td></td>\n<td>Sync Masternode list from other connected clients</td>\n</tr>\n<tr>\n<td><code>dseg</code> message</td>\n<td style=\"text-align:center\">\u2192</td>\n<td></td>\n<td>Syncing node requests masternode list</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><a href=\"core-ref-p2p-network-masternode-messages#section-ssc\"><code>ssc</code> message</a></td>\n<td>Number of entries in masternode list (MASTERNODE_SYNC_LIST)<br><br>Only sent if requesting entire list</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><a href=\"core-ref-p2p-network-data-messages#section-inv\"><code>inv</code> message</a>(s) (mnb)</td>\n<td>MSG_MASTERNODE_ANNOUNCE</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><a href=\"core-ref-p2p-network-data-messages#section-inv\"><code>inv</code> message</a>(s) (mnp)</td>\n<td>MSG_MASTERNODE_PING</td>\n</tr>\n<tr>\n<td><a href=\"core-ref-p2p-network-data-messages#section-getdata\"><code>getdata</code> message</a>(s) (mnb)</td>\n<td style=\"text-align:center\">\u2192</td>\n<td></td>\n<td>(Optional)</td>\n</tr>\n<tr>\n<td><a href=\"core-ref-p2p-network-data-messages#section-getdata\"><code>getdata</code> message</a>(s) (mnp)</td>\n<td style=\"text-align:center\">\u2192</td>\n<td></td>\n<td>(Optional)</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><code>mnb</code> message(s)</td>\n<td>(If requested) Masternode announce message</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><code>mnp</code> message(s)</td>\n<td>(If requested) Masternode ping message</td>\n</tr>\n<tr>\n<td><strong>3. Masternode payments</strong></td>\n<td style=\"text-align:center\"></td>\n<td></td>\n<td>Ask node for all payment votes it has (new nodes will only return votes for future payments)</td>\n</tr>\n<tr>\n<td><code>mnget</code> message</td>\n<td style=\"text-align:center\">\u2192</td>\n<td></td>\n<td>Syncing node requests masternode payment sync</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><a href=\"core-ref-p2p-network-masternode-messages#section-ssc\"><code>ssc</code> message</a></td>\n<td>Number of entries in masternode payment list</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><a href=\"core-ref-p2p-network-data-messages#section-inv\"><code>inv</code> message</a>(s) (mnw)</td>\n<td>MSG_MASTERNODE_PAYMENT_VOTE</td>\n</tr>\n<tr>\n<td><a href=\"core-ref-p2p-network-data-messages#section-getdata\"><code>getdata</code> message</a>(s) (mnw)</td>\n<td style=\"text-align:center\">\u2192</td>\n<td></td>\n<td>(Optional)</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">\u2190</td>\n<td><code>mnw</code> message(s)</td>\n<td>(If requested) Masternode payment vote message</td>\n</tr>\n<tr>\n<td><strong>4. Governance</strong></td>\n<td style=\"text-align:center\"></td>\n<td></td>\n<td>See <a href=\"core-guide-dash-features-governance\">Governance sync</a></td>\n</tr>\n</tbody>\n</table></div>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-ongoing-sync\"></div>Ongoing Sync<a class=\"fa fa-anchor\" href=\"#section-ongoing-sync\"></a></h2>\n<p>Once a masternode completes an initial full sync, continuing synchronization is maintained by the exchange of P2P messages with other nodes. This diagram shows an overview of the messages exchanged to keep the masternode list, masternode payments, and governance objects synchronized between masternodes.</p>\n<p><img src=\"https://dash-docs.github.io/img/dev/en-masternode-sync-ongoing.svg\" alt=\"Masternode Sync (Ongoing)\"></p>\n<p><strong>Recurring Ping</strong></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>Note: Deprecated following activation of DIP3.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>Each masternode issues a ping (<code>mnp</code> message) periodically to notify the network that it is still online. Masternodes that do not issue a ping for 3 hours will be put into the <code>MASTERNODE_NEW_START_REQUIRED</code> state and will need to issue a masternode announce (<code>mnb</code> message).</p>\n<p><strong>Masternode List</strong></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>Note: Deprecated following activation of DIP3.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>After the initial masternode list has been received, it is kept current by a combination of the periodic <code>mnp</code> messages received from other masternodes, the <code>mnb</code> messages sent by masternodes as they come online, and <code>mnv</code> messages to verify that other masternodes are valid.</p>\n<p>Also, <code>dseg</code> messages can be sent to request masternode info when messages are received that have been signed by an unrecognized masternode (most masternode/governance messages include a <code>vin</code> value that can be used to verify the masternode&#39;s unspent 1000 Dash).</p>\n<p>Unsynchronized peers may send a <code>dseg</code> message to request the entire masternode list.</p>\n<p><strong>Masternode Payment</strong></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>Note: Deprecated following activation of DIP3.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>After the initial masternode payment synchronization, payment information is kept current via the <code>mnw</code> messages relayed on the network. Unsynchronized peers may send a <code>mnget</code> message to request masternode payment sync.</p>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-sync-schedule\"></div>Sync Schedule<a class=\"fa fa-anchor\" href=\"#section-sync-schedule\"></a></h2>\n<p>Prior to the deterministic masternode system introduced by DIP3 in Dash Core 0.13, the following additional sync actions were also required.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th><strong>Period (seconds)</strong></th>\n<th><strong>Action</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>MN Check</td>\n<td><img src=\"https://dash-docs.github.io/img/icons/icon_warning.svg\" alt=\"Warning icon\"> <em>Deprecated following activation of DIP3 and Spork 15</em><br><br>Check the state of each masternode that is still funded and not banned. The action occurs once per second, but individual masternodes are only checked at most every 5 seconds (only a subset of masternodes are checked each time it runs) (masternodeman.cpp)</td>\n</tr>\n<tr>\n<td>60</td>\n<td>MN Check/Remove</td>\n<td><img src=\"https://dash-docs.github.io/img/icons/icon_warning.svg\" alt=\"Warning icon\"> <em>Deprecated following activation of DIP3 and Spork 15</em><br><br>Remove spent masternodes and check the state of inactive ones (masternodeman.cpp)</td>\n</tr>\n<tr>\n<td>60</td>\n<td>MN Payment Check/Remove</td>\n<td><img src=\"https://dash-docs.github.io/img/icons/icon_warning.svg\" alt=\"Warning icon\"> <em>Deprecated following activation of DIP3 and Spork 15</em><br><br>Remove old masternode payment votes/blocks (masternode-payments.cpp)</td>\n</tr>\n<tr>\n<td>300</td>\n<td>Full verification</td>\n<td><img src=\"https://dash-docs.github.io/img/icons/icon_warning.svg\" alt=\"Warning icon\"> <em>Deprecated following activation of DIP3 and Spork 15</em><br><br>Verify masternodes via direct requests (<code>mnv</code> messages - note time constraints in the Developer Reference section) (masternodeman.cpp)</td>\n</tr>\n<tr>\n<td>600</td>\n<td>Manage State</td>\n<td><img src=\"https://dash-docs.github.io/img/icons/icon_warning.svg\" alt=\"Warning icon\"> <em>Deprecated following activation of DIP3 and Spork 15</em><br><br>Sends masternode pings (<code>mnp</code> message). Also sends initial masternode broadcast (<code>mnb</code> message) for local masternodes. (activemasternode.cpp)</td>\n</tr>\n</tbody>\n</table></div>\n\n</div>"
}