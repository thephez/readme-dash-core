{
 "_id": "5db087de29616900509db9b0",
 "version": "5daf2e65f4109c0040fd51e5",
 "updatedAt": "2019-11-07T21:13:41.558Z",
 "createdAt": "2019-10-23T17:03:26.338Z",
 "project": "5daf2e65f4109c0040fd51e1",
 "user": "5b8400d7185d5e00036dcc3b",
 "parentDoc": "5db076c3dbccd5005ce07e4f",
 "category": "5db061df6d7d670050694628",
 "__v": 3,
 "updates": [],
 "next": {
  "pages": [
   {
    "category": "Core Reference",
    "slug": "core-ref-p2p-network-deprecated-messages",
    "name": "Deprecated Messages",
    "icon": "file-text-o",
    "type": "doc"
   }
  ],
  "description": ""
 },
 "link_external": false,
 "link_url": "",
 "sync_unique": "",
 "hidden": false,
 "api": {
  "results": {
   "codes": [
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 200
    },
    {
     "name": "",
     "code": "{}",
     "language": "json",
     "status": 400
    }
   ]
  },
  "auth": "required",
  "params": [],
  "url": "",
  "method": "get"
 },
 "isReference": false,
 "order": 9,
 "body": "The following network messages enable the long-living masternode quorum (<<glossary:LLMQ>>) features built in to Dash.\n\n# Distributed Key Generation\n\nThe following network messages enable the creation of long living masternode quorums (LLMQs) as described in [DIP6](https://github.com/dashpay/dips/blob/master/dip-0006.md).\n\nWith the exception of the [`qfcommit` message](core-ref-p2p-network-quorum-messages#section-qfcommit), these messages are for intra-quorum communication only and are not propagated on the Dash network.\n\n## qcontrib\n\n*Added in protocol version 70214 of Dash Core*\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"This message is used for intra-quorum communication and is only sent to the <<glossary:masternodes>> in the LLMQ and <<glossary:nodes>> that are monitoring in Watch Mode for auditing/debugging purposes.\"\n}\n[/block]\nThe [`qcontrib` message](core-ref-p2p-network-quorum-messages#section-qcontrib) is used by each member of the DKG process to send key contributions to all other members.\n\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| 1 | llmqType | uint8_t | The type of LLMQ\n| 32 | quorumHash | uint256 | \tThe quorum identifier\n| 32 | proTxHash | uint256 | The [ProRegTx](core-ref-transactions-special-transactions#section-proregtx) hash of the complaining member\n| 1-9 | vvecSize | compactSize uint | The size of the verification vector\n| 48 * `vvecSize` | vvec | BLSPubKey[] | The verification vector\n| 48 | ephemeralPubKey | BLSPubKey | Ephemeral BLS public key used to encrypt secret key contributions\n| 32 | iv | uint256 | Initialization vector\n| 1-9 | skCount | compactSize uint | Number of encrypted secret key contributions\n| (1 + 32) * (`skCount`) | skContributions | byte[] | Secret key contributions encrypted to recipient masternodes\u2019 BLS public operator key.<br><br>Each contribution consists of:<br>- Size: 1 byte<br>- Secret Key: 32 bytes\n| 96 | sig | byte[] | BLS signature, signed with the operator key of the contributing masternode\n\nMore information can be found in the [Contribution phase section of DIP6](https://github.com/dashpay/dips/blob/master/dip-0006.md#2-contribution-phase).\n\nThe following annotated hexdump shows a [`qcontrib` message](core-ref-p2p-network-quorum-messages#section-qcontrib). (The message header has been omitted.)\n\n``` text\n01  ........................................ LLMQ Type: 1 (LLMQ_50_60)\n\ncb9a1552340175a8232437eb8ceceaea\n4b90a0f75caff20ee12d230b00000000 ...........  Quorum Hash\n\ncd1c97c52ccf163ee5dc264d411efc90\nb07729cd34d9d2e7c7b3ca4b2a4e77cf ........... ProRegTx Hash\n\n1e ......................................... Verification Vector Size: 30\n\nVerification Vector (Truncated)\n| 8da71ba5030e28c6c4de5e0eb1660d0f\n| a9fd21ef4fef700a556f10286c9c34fb\n| beb36fffb5b2a552a40d6c8e27aac338\n| [...]\n| 99d8649d226261162bcb5a11617d1732\n| 553b8358d85b1d9e12a88eb3e979fb7c\n| e49b5a21a82a74e9d06233199cb73db4 ......... Verification Vector (1440 bytes)\n\n8d664929b596cdc8eb835d652944d61b\n7fd21fd60ba0288af4f9e3a10658c8a8\n56467082c728e2037791166705ada03a ........... Ephemeral BLS Public Key\n\n93037a05b65adad6f5d44edc43500bff\n71605f0e5f90ab92e3e0b46461c1c64d ........... IV Seed\n\n32 ......................................... Contribution count: 50\nContributions\n| Secret Key Contribution #1\n| | 20 ..................................... Contribution Size: 32 bytes\n| | | 31f3e8e5b2cc2063ee7fd1dd469dca12\n| | | 4bdf506ee46fe825d5537aa3ce838225 ..... Encrypted Secret Key contribution\n|\n| Secret Key Contribution #2\n| | 20 ..................................... Contribution Size: 32 bytes\n| | | a6b3ff696ffc5e0c0a9b444c515edc48\n| | | 5a9ccea0268c2a445fac5e24feda51a9 ..... Encrypted Secret Key contribution\n|\n| [...] .................................... 47 contributions omitted\n|\n| Secret Key Contribution #50\n| | 20 ..................................... Contribution Size: 32 bytes\n| | | 25f54cff411a577db9a416a60067f512\n| | | 0750c77720207eb1484c90767b72faf8 ..... Encrypted Secret Key contribution\n\n81f1003546f6735849c5691af93d324d\n3a719fc4bb6d719907de3bce9833228e\n648d03cd80666d70600fa8c936d30046\n07bd444af3e494fb2a21273fcfa51986\n3c4e139c67d2ffe0df07ac27ae63a0c8\ne000da1aeda5f98ec9e64b801681bfc1 ........... BLS signature (Operator Key)\n```\n\n## qcomplaint\n\n*Added in protocol version 70214 of Dash Core*\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"This message is used for intra-quorum communication and is only sent to the <<glossary:masternodes>> in the LLMQ and <<glossary:nodes>> that are monitoring in Watch Mode for auditing/debugging purposes.\"\n}\n[/block]\nThe [`qcomplaint` message](core-ref-p2p-network-quorum-messages#section-qcomplaint) is used to notify other members in the DKG process of any members that provided no contribution or an invalid secret key contribution. The notifications are divided into 2 fields:\n\n - `badMembers` - Sets a bit for each member that failed to provide a contribution\n - `complaints` - Sets a bit for each member that provided an invalid contribution\n\nIf a threshold number of quorum participants indicate a masternode didn't contribute, that masternode will be excluded from the quorum. Members that simply have a complaint against them are given an opportunity to respond (via a [`qjustify` message](core-ref-p2p-network-quorum-messages#section-qjustify)) to attempt to prove to all participants that they did participate.\n\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| 1 | llmqType | uint8_t | The type of LLMQ\n| 32 | quorumHash | uint256 | \tThe quorum identifier\n| 32 | proTxHash | uint256 | The [ProRegTx](core-ref-transactions-special-transactions#section-proregtx) hash of the complaining member\n| 1-9 | badBitSize | compactSize uint | Number of bits in the bad members bitvector\n| (`badBitSize` + 7) / 8 | badMembers | byte[] | The bad members bitvector\n| 1-9 | complaintsBitSize | compactSize uint | Number of bits in the complaints bitvector\n| (`complaints`<br>`BitSize` + 7) / 8 | complaints | byte[] | The complaints bitvector\n| 96 | sig | byte[] | BLS signature, signed with the operator key of the contributing masternode\n\nMore information can be found in the [Complaining phase section of DIP6](https://github.com/dashpay/dips/blob/master/dip-0006.md#3-complaining-phase).\n\nThe following annotated hexdump shows a [`qcomplaint` message](core-ref-p2p-network-quorum-messages#section-qcomplaint). (The message header has been omitted.)\n\n``` text\n01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\nb34b2bcb3430f403663e37be9c63c88e\n4ca1f12c41846064cf960a0800000000 ........... Quorum Hash\n\nb375607540bd9c6e4a5452d8c7a6a626\nec715222a0650321487843c79cac67d5 ........... ProRegTx hash\n\n32 ......................................... Bad member bitvector size: 50\n08800200004000 ............................. Bad members\n\n32 ......................................... Complaints bitvector size: 50\n00020080040000 ............................. Complaints\n\n0639b0e8ccb667c161207ddc03183d4e\nbb632eeb60f29e351963032a673abd61\n3fb3e847dff78699481193cf385f0e08\n0fdf518e26ef1e258b724408b1ee9d70\n511696092b6c2ebfad5e24154a7f859f\n0efe3fcb8d7042da624f7298876cc98e ........... BLS signature (Operator Key)\n```\n\n## qjustify\n\n*Added in protocol version 70214 of Dash Core*\n\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"This message is used for intra-quorum communication and is only sent to the <<glossary:masternodes>> in the LLMQ and <<glossary:nodes>> that are monitoring in Watch Mode for auditing/debugging purposes.\"\n}\n[/block]\nThe [`qjustify` message](core-ref-p2p-network-quorum-messages#section-qjustify) is used to respond to complaints. This provides a way for <<glossary:nodes>> that have been complained about to offer proof of correct behavior. If a valid justification is not provided, all other nodes mark it as a bad. If a valid justification is provided, the complaining node is marked as bad instead (since it submitted a bad complaint).\n\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| 1 | llmqType | uint8_t | The type of LLMQ\n| 32 | quorumHash | uint256 | \tThe quorum identifier\n| 32 | proTxHash | uint256 | The [ProRegTx](core-ref-transactions-special-transactions#section-proregtx) hash of the complaining member\n| 1-9 | skContributions<br>Count | compactSize uint | Number of unencrypted secret key contributions\n| 36 * `skContributions`<br>`Count` | skContribution | SKContribution | Member index and secret key contribution for members justifying complaints\n| 96 | sig | byte[] | BLS signature, signed with the operator key of the contributing masternode\n\nAn `SKContribution` consists of:\n\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| 4 | skContributionMember | uint32_t | Index of the member for which justification is provided\n| 32 | skContributions | byte[] | Unencrypted secret key contribution for the member contained in skContributionMember\n\nMore information can be found in the [Justification phase section of DIP6](https://github.com/dashpay/dips/blob/master/dip-0006.md#4-justification-phase).\n\nThe following annotated hexdump shows a [`qjustify` message](core-ref-p2p-network-quorum-messages#section-qjustify). (The message header has been omitted.)\n\n``` text\n01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\nb34b2bcb3430f403663e37be9c63c88e\n4ca1f12c41846064cf960a0800000000 ........... Quorum Hash\n\ne7d909afba6848f3fdf98b2da31db07e\n3fbee621d58c469dce96d6283bcd4b25 ........... ProRegTx hash\n\n05 ......................................... Contribution count: 5\n\nContribution #1\n| 16000000 ................................. Member Index: 22\n|\n| 57b63ec5ae0a101f0d93bb60af70bf22\n| c21bd3a7705e1aecb9559d6b151d953f ......... Unencrypted secret key contribution\n\nContribution #2\n| 17000000 ................................. Member Index: 22\n|\n| 0ee1f0f0f2570589e81d2a4f8165b105\n| 28436a1a75cf3469fa81090f2d856150 ......... Unencrypted secret key contribution\n\n[...] ...................................... 3 more contributions omitted\n\n8d63d10e242ac97c6324e9a40d6e690e\n4bb7fe0750b7d204f7e988a324720189\n68408d2d0621bbaba8380ad4aaf342ea\n138ce9a59ed9ca82995c155609488dcc\n5ac35f483b695a0624e5ab0745f7f9e2\n051edf1b3b1f0e1b1d55d185d25e0ed7 ........... BLS signature (Operator Key)\n```\n\n## qpcommit\n\n*Added in protocol version 70214 of Dash Core*\n\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"This message is used for intra-quorum communication and is only sent to the <<glossary:masternodes>> in the LLMQ and <<glossary:nodes>> that are monitoring in Watch Mode for auditing/debugging purposes.\"\n}\n[/block]\nThe [`qpcommit` message](core-ref-p2p-network-quorum-messages#section-qpcommit) is used to exchange premature commitment messages for verification and selection of the final commitment.\n\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| 1 | llmqType | uint8_t | The type of LLMQ\n| 32 | quorumHash | uint256 | The quorum identifier\n| 32 | proTxHash | uint256 | The [ProRegTx](core-ref-transactions-special-transactions#section-proregtx) hash of the complaining member\n| 1-9 | validMembersSize | compactSize uint | Bit size of the `validMembers` bitvector\n| (`valid`<br>`MembersSize` + 7) / 8 | validMembers | byte[] | Bitset of valid members in this commitment\n| 48 | quorumPublicKey | uint256 | The quorum public key\n| 32 | quorumVvecHash | byte[] | The hash of the quorum verification vector\n| 96 | quorumSig | BLSSig | Threshold signature, signed with the threshold signature share of the committing member\n| 96 | sig | byte[] | BLS signature, signed with the operator key of the contributing masternode\n\nMore information can be found in the [Commitment phase section of DIP6](https://github.com/dashpay/dips/blob/master/dip-0006.md#5-commitment-phase).\n\nThe following annotated hexdump shows a [`qpcommit` message](core-ref-p2p-network-quorum-messages#section-qpcommit). (The message header has been omitted.)\n\n``` text\n01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\ncb9a1552340175a8232437eb8ceceaea\n4b90a0f75caff20ee12d230b00000000 ........... Quorum Hash\n\n59c38b8d6a0664411f92a6326e8ef070\n7ecf185405252854ddb477d89127a32d ........... ProRegTx hash\n\n32 ......................................... Valid member bitvector size: 50\nffffffffffff03 ............................. Valid members\n\n102809b8649209a15fceb3984014eb39\n70ca9bd2464b2f84353a3353f4d612eb\n7ca6daaf723170cdbdad40c5cf44f87b ........... Quorum BLS Public Key\n\n17431ce7dfecb9bba4ccba5921514d24\nfe267c61078bdfe29d90774a3b766ad5 ........... Quorum Verification Vector Hash\n\n94f7417e0ed56ada7116cf4f1e400748\ndeb2e2040babd540f21925b2eec8d4df\n75d3e0fc3323d083db76f66ce6128a13\n0f1b2c4725076dae2283bbecbf2e1230\n72cc9cec244337008bf82a670ab9e2ee\n6220dd736a1a70c9ca87867ca55f8665 ........... BLS Threshold signature\n\n85723fe503bba8ac814eab0f28f1fd07\n49927528c01b635d11d3f2843ce3f7e1\n6223c7e9a9e1f70916159c965acae8bf\n09d16dc85267ec4081907adc966eae69\nb6a5077267fdc61cdb192faffa27bed9\n2883559bab2ab81cef6253452622b30c ........... BLS signature (Operator Key)\n```\n\n## qfcommit\n\nThe [`qfcommit` message](core-ref-p2p-network-quorum-messages#section-qfcommit) is used to finalize a <<glossary:Long-Living Masternode Quorum>> setup by aggregating the information necessary to mine the on-chain [QcTx](core-ref-transactions-special-transactions#section-qctx) special transaction. The message contains all the necessary information required to validate the long-living masternode quorum's signing results.\n\nIt is possible to receive multiple valid final commitments for the same DKG session. These should only differ in the number of signers, which can be ignored as long as there are at least `quorumThreshold` number of signers. The set of valid members for these final commitments should always be the same, as each member only creates a single premature commitment. This means that only one set of valid members (and thus only one quorum verification vector and quorum <<glossary:public key>>) can gain a majority. If the threshold is not reached, there will be no valid final commitment.\n\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| 2 | version | uint16_t | Version of the final commitment message\n| 1 | llmqType | uint8_t | The type of LLMQ\n| 32 | quorumHash | uint256 | The quorum identifier\n| 1-9 | signersSize | compactSize uint | Bit size of the signers bitvector\n| (bitSize + 7) / 8 | signers | byte[] | Bitset representing the aggregated signers of this final commitment\n| 1-9 | validMembersSize | compactSize uint | Bit size of the `validMembers` bitvector\n| (bitSize + 7) / 8 | validMembers | byte[] | Bitset of valid members in this commitment\n| 48 | quorumPublicKey | BLSPubKey | The quorum public key\n| 32 | quorumVvecHash | uint256 | The hash of the quorum verification vector\n| 96 | quorumSig | byte[] | Recovered threshold signature\n| 96 | sig | byte[] | Aggregated BLS signatures from all included commitments\n\nMore information can be found in the [Finalization phase section of DIP6](https://github.com/dashpay/dips/blob/master/dip-0006.md#6-finalization-phase).\n\nThe following annotated hexdump shows a [`qfcommit` message](core-ref-p2p-network-quorum-messages#section-qfcommit). (The message header has been omitted.)\n\n``` text\n0100 ....................................... Message Version: 1\n01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\ncb9a1552340175a8232437eb8ceceaea\n4b90a0f75caff20ee12d230b00000000 ........... Quorum Hash\n\n32 ......................................... Signer bitvector size: 50\nffffffffffff03 ............................. Signers\n\n32 ......................................... Valid member bitvector size: 50\nffffffffffff03 ............................. Valid members\n\n102809b8649209a15fceb3984014eb39\n70ca9bd2464b2f84353a3353f4d612eb\n7ca6daaf723170cdbdad40c5cf44f87b ........... Quorum BLS Public Key\n\n17431ce7dfecb9bba4ccba5921514d24\nfe267c61078bdfe29d90774a3b766ad5 ........... Quorum Verification Vector Hash\n\n083388b91a2f8f7f4ea35469f25ee16a\n21b3e03b02936675897f74424d6de748\n66b34dcc5861fd3f5f661ea1ed124a08\n0b165f21b1f2db18c4c37c82f8a8d350\n9a6f52a14c643dab71a4dced78ae9a42\ndc982e89a92606df537b8918881e9c95 ........... Quorum BLS Recovered Threshold Sig\n\n0d131c7062253671f9c8ebb39a9b0057\nd78dc67e236b55086cbb0624c7f4abcc\n0a26557bfad3092bd38ded4e3cca6c43\n0dda2e73a99ca3d359631cb99a121c5e\n92cea06ef4c03bb18ad9e90559104550\nc8a042dc51aa58a26c134405fc3234ff ........... Quorum Aggregate BLS Sig\n```\n\n# Signing Sessions\n\nThe following network messages enable the long living masternode quorum (LLMQ) message signing sessions described in [DIP7](https://github.com/dashpay/dips/blob/master/dip-0007.md).\n\nWith the exception of the [`qsendrecsigs` message](core-ref-p2p-network-quorum-messages#section-qsendrecsigs) and the [`qsigrec` message](core-ref-p2p-network-quorum-messages#section-qsigrec), these messages are for intra-quorum communication only and are not propagated on the Dash network.\n\n## qbsigs\n\n*Added in protocol version 70214 of Dash Core*\n\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"This message is used for intra-quorum communication and is only sent to the <<glossary:masternodes>> in the LLMQ and <<glossary:nodes>> that are monitoring in Watch Mode for auditing/debugging purposes.\",\n  \"title\": \"\"\n}\n[/block]\nThe [`qbsigs` message](core-ref-p2p-network-quorum-messages#section-qbsigs) is used to send batched signature shares in response to a [`qgetsigs` message](core-ref-p2p-network-quorum-messages#section-qgetsigs).\n\n[block:callout]\n{\n  \"type\": \"info\",\n  \"body\": \"The number of messages that can be sent in a batch is limited to 400 (as defined by `MAX_MSGS_TOTAL_BATCHED_SIGS` in Dash Core).\"\n}\n[/block]\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| Varies | batchCount | compactSize uint | Number of batched signature shares |\n| Varies | msgs | CBatchedSigShares | Batches of signature shares |\n\nCBatchedSigShares:\n\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| Varies | sessionId | varint | Signing session ID |\n| Varies | shareCount | compactSize uint | Number of shares |\n| shareCount * 98 | sigShares | <uint16_t, CBLSLazySignature> | Index (2 bytes) and BLS Signature share (96 bytes) |\n\nThe following annotated hexdump shows a [`qbsigs` message](core-ref-p2p-network-quorum-messages#section-qbsigs). (The message header has been omitted.)\n\n``` text\n02 ......................................... Number of signature share batches: 2\n\nSignature Share Batch 1\n| 84d843 ................................... Session ID\n|\n| 01 ....................................... Share count: 1\n|\n| Share\n| | 2100 ................................... Index\n|\n| | 0fbd0c0981b79544c3e80d1a2eed13fe\n| | f08c731b0156654675209812f9b2b8f3\n| | ec23868d26890a0e85e5cec4ad0e2d46\n| | 01293cf7e41841fda5865063e7354f36\n| | e8a5c13d2c2d265a778f41e807b3cc63\n| | 81e202ecf923c62bbb69ecc713bdf86d ....... BLS Signature share\n\nSignature Share Batch 2\n| 84d844 ................................... Session ID\n|\n| 01 ....................................... Share Count: 1\n|\n| Share\n| | 2100 ................................... Index\n| |\n| | 9570d97e41b78045b51fba3d4f1ea38d\n| | 7a0e007535ce6beb1e03eff163b421fd\n| | b8125142a12f92aa82770de7bb038207\n| | 13ccc72dd6d9bf91ecc2835da54a0afb\n| | 0c0fa5d7a214a020ca650ca202ddff29\n| | c3cac4033098297d2aaee098db5bfe2f ....... BLS Signature share\n```\n\n## qgetsigs\n\n*Added in protocol version 70214 of Dash Core*\n\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"This message is used for intra-quorum communication and is only sent to the <<glossary:masternodes>> in the LLMQ and <<glossary:nodes>> that are monitoring in Watch Mode for auditing/debugging purposes.\"\n}\n[/block]\nThe [`qgetsigs` message](core-ref-p2p-network-quorum-messages#section-qgetsigs) is used to request signature shares. The response to a [`qgetsigs` message](core-ref-p2p-network-quorum-messages#section-qgetsigs) is a [`qbsigs` message](core-ref-p2p-network-quorum-messages#section-qbsigs).\n[block:callout]\n{\n  \"type\": \"info\",\n  \"body\": \"The number of inventories in a [`qgetsigs` message](core-ref-p2p-network-quorum-messages#section-qgetsigs) is limited to 200 (as defined by `MAX_MSGS_CNT_QGETSIGSHARES` in Dash Core).\"\n}\n[/block]\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| Varies | count | compactSize uint | Number of signature shares requested |\n| Varies | sessionId | varint | Signing session ID\n| Varies | invSize | compactSize uint | Inventory size\n| Varies | inv | CAutoBitSet | Quorum signature inventory |\n\nThe following annotated hexdump shows a [`qgetsigs` message](core-ref-p2p-network-quorum-messages#section-qgetsigs). (The message header has been omitted.)\n\n``` text\n02 ......................................... Count: 2\n\nSignature share request 1\n| 80db21 ................................... Session ID\n| 32 ....................................... Inventory size: 50\n| 012900 ................................... Inventory\n\nSignature share request 2\n| 80db22 ................................... Session ID\n| 32 ....................................... Inventory Size: 50\n| 012900 ................................... Inventory\n```\n\n## qsendrecsigs\n\n*Added in protocol version 70214 of Dash Core*\n\nThe [`qsendrecsigs` message](core-ref-p2p-network-quorum-messages#section-qsendrecsigs) is used to notify a <<glossary:peer>> to send plain <<glossary:LLMQ>> recovered signatures (inventory type `MSG_QUORUM_RECOVERED_SIG`). Otherwise the peer would only announce/send the higher level messages produced when a recovered signature is found (e.g. InstantSend [`islock` messages](core-ref-p2p-network-instantsend-messages#section-islock) or ChainLock [`clsig` messages](core-ref-p2p-network-instantsend-messages#section-clsig)).\n[block:callout]\n{\n  \"type\": \"info\",\n  \"body\": \"SPV nodes should not send this message as they are usually only interested in the higher level messages.\"\n}\n[/block]\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| 1 | fSendRecSigs | bool | 0 - Notify peer to not send plain LLMQ recovered signatures<br>1 - Notify peer to send plain LLMQ recovered signatures (default for Dash Core nodes)\n\nThe following annotated hexdump shows a [`qsendrecsigs` message](core-ref-p2p-network-quorum-messages#section-qsendrecsigs). (The message header has been omitted.)\n\n``` text\n01 ................................. Request recovered signatures: Enabled (1)\n```\n\n## qsigrec\n\n*Added in protocol version 70214 of Dash Core*\n\nThe [`qsigrec` message](core-ref-p2p-network-quorum-messages#section-qsigrec) is used to provide recovered signatures and related quorum details to <<glossary:nodes>> that have requested this information via the [`qsendrecsigs` message](core-ref-p2p-network-quorum-messages#section-qsendrecsigs).\n\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| 1 | llmqType | uint8_t | The type of LLMQ\n| 32 | quorumHash | uint256 | The quorum hash\n| 32 | id | uint256 | The signing request id\n| 32 | msgHash | uint256 | The message hash\n| 96 | sig | byte[] | The final recovered BLS threshold signature\n\nMore information can be found in the [Recovered threshold signatures section of DIP7](https://github.com/dashpay/dips/blob/master/dip-0007.md#recovered-threshold-signatures).\n\nThe following annotated hexdump shows a [`qsigrec` message](core-ref-p2p-network-quorum-messages#section-qsigrec). (The message header has been omitted.)\n\n**Note:** The following [`qsigrec` message](core-ref-p2p-network-quorum-messages#section-qsigrec) corresponds to the example [`islock` message](core-ref-p2p-network-instantsend-messages#section-islock) hexdump. The message hash below corresponds to the `islock` TXID field and the BLS signature matches the BLS signature of the `islock` example.\n\n``` text\n01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\n7d0befca14fa9e594aa19deab138ef28\n23fe838c89ed9be6ddc63c0200000000 ........... Quorum Hash\n\n0f1937c60f35640d063eae8eb288af21\na2ec0ec69b58b20c52f5d438eaabd54d ........... Signing Request ID\n\ne2e1c797576d8b13c83e929684b9aacd\n553c20a34e2d11e38bdcaaf8e1de1680 ........... Message Hash\n\n0f055c2064885d446f83d51b9bb09892\n7ea0375a0f6a3f3402abf158ece67e00\n81049b8a8f45d254b64574cef194ef31\n197e450fba1196d652f2e1421d3b80ae\nf429c10eabd4ab9289e9a8f80f6989b7\na11e5e7930deccc3e11a931fc9524f06 ........... LLMQ BLS Signature (96 bytes)\n```\n\n## qsigsesann\n\n*Added in protocol version 70214 of Dash Core*\n\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"This message is used for intra-quorum communication and is only sent to the <<glossary:masternodes>> in the LLMQ and <<glossary:nodes>> that are monitoring in Watch Mode for auditing/debugging purposes.\"\n}\n[/block]\nThe [`qsigsesann` message](core-ref-p2p-network-quorum-messages#section-qsigsesann) is used to announce the sessionId for a signing session. The sessionId will be used for all P2P messages related to that session.\n\n[block:callout]\n{\n  \"type\": \"info\",\n  \"body\": \"The maximum number of announcements in a [`qsigsesann` message](core-ref-p2p-network-quorum-messages#section-qsigsesann) is limited to 100 (as defined by `MAX_MSGS_CNT_QSIGSESANN` in Dash Core).\"\n}\n[/block]\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| Varies | count | compactSize uint | Number of session announcements |\n| Varies | sessionId | varint | Signing session ID (must be less than the maximum uint32_t value)\n| 1 | llmqType | uint8_t | The LLMQ type\n| 32 | quorumHash | uint256 | The quorum identifier\n| 32 | id | uint256 | The signing request id\n| 32 | msgHash | uint256 | The message hash\n\nThe following annotated hexdump shows a [`qsigsesann` message](core-ref-p2p-network-quorum-messages#section-qsigsesann). (The message header has been omitted.)\n\n``` text\n02 ......................................... Count: 2\n\nSession Announcement 1\n| 84d843 ................................... Session ID\n|\n| 01 ....................................... LLMQ Type: 1 (LLMQ_50_60)\n|\n| a34d3ae6b33cb1199c3e5e1cb5a2a55c\n| 91e69bb5df2bf80ba1cb0a0d00000000 ......... Quorum Hash\n|\n| 89bbc2e5741a9f706e8d33dee4132037\n| 8c33511768c5e3d6cdb2a1b7b731360b ......... Signing request ID\n|\n| d2b41a19237e370b4b091545b203bc0c\n| 02ca7e0d5daebf12bb24b13064ed4149 ......... Message Hash\n\nSession Announcement 2\n| 84d844 ................................... Session ID\n|\n| 01 ....................................... LLMQ Type: 1 (LLMQ_50_60)\n|\n| a34d3ae6b33cb1199c3e5e1cb5a2a55c\n| 91e69bb5df2bf80ba1cb0a0d00000000 ......... Quorum Hash\n|\n| 54f73deb42a8ed9b72b9c0535a72f54d\n| 5789bbe0dbea2e184c3089f9e8f65c3e ......... Signing request ID\n|\n| af2e5d730cd37cd911b92db117b4ab99\n| 90a3c0300ce39177d0d31be5b47c2361 ......... Message Hash\n```\n\n## qsigsinv\n\n*Added in protocol version 70214 of Dash Core*\n\n[block:callout]\n{\n  \"type\": \"warning\",\n  \"body\": \"This message is used for intra-quorum communication and is only sent to the <<glossary:masternodes>> in the LLMQ and <<glossary:nodes>> that are monitoring in Watch Mode for auditing/debugging purposes.\",\n  \"title\": \"\"\n}\n[/block]\nThe [`qsigsinv` message](core-ref-p2p-network-quorum-messages#section-qsigsinv) (quorum signature inventory) announces one or more quorum signature share inventories known by the transmitting peer.\n\n[block:callout]\n{\n  \"type\": \"info\",\n  \"body\": \"The maximum number of inventories in a [`qsigsinv` message](core-ref-p2p-network-quorum-messages#section-qsigsinv) is limited to 200 (as defined by `MAX_MSGS_CNT_QSIGSHARESINV` in Dash Core).\"\n}\n[/block]\n| Bytes | Name | Data type | Description |\n| --- | --- | --- | --- |\n| Varies | count | compactSize uint | Number of session announcements |\n| Varies | sessionId | varint | Signing session ID (must be less than the maximum uint32_t value) |\n| Varies | invSize | compactSize uint | Inventory size\n| Varies | inv | CAutoBitSet | Quorum signature inventory |\n\nThe following annotated hexdump shows a [`qsigsinv` message](core-ref-p2p-network-quorum-messages#section-qsigsinv). (The message header has been omitted.)\n\n``` text\n02 ......................................... Count: 2\n\n84d844 ..................................... Session ID\n32 ......................................... Inventory size: 50\n011a040200 ................................. Inventory\n\n84d843 ..................................... Session ID\n32 ......................................... Inventory size: 50\n011a0700 ................................... Inventory\n```\n\n# Debugging\n\n## qwatch\n\n*Added in protocol version 70214 of Dash Core*\n\nThe [`qwatch` message](core-ref-p2p-network-quorum-messages#section-qwatch) tells the receiving <<glossary:peer>> to relay <<glossary:LLMQ>> messages (`qcontrib` messages, [`qcomplaint` messages](core-ref-p2p-network-quorum-messages#section-qcomplaint), [`qjustify` messages](core-ref-p2p-network-quorum-messages#section-qjustify), and [`qpcommit` messages](core-ref-p2p-network-quorum-messages#section-qpcommit)).\n\nThere is no payload in a [`qwatch` message](core-ref-p2p-network-quorum-messages#section-qwatch).  See the [message header section](core-ref-p2p-network-message-headers) for an example of a message without a payload.",
 "excerpt": "",
 "slug": "core-ref-p2p-network-quorum-messages",
 "type": "basic",
 "metadata": {
  "description": "",
  "title": "",
  "image": []
 },
 "title": "Quorum Messages",
 "id": "5db087de29616900509db9b0",
 "isApi": false,
 "body_html": "<div class=\"magic-block-textarea\"><p>The following network messages enable the long-living masternode quorum (&lt;&lt;glossary:LLMQ&gt;&gt;) features built in to Dash.</p>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-distributed-key-generation\"></div>Distributed Key Generation<a class=\"fa fa-anchor\" href=\"#section-distributed-key-generation\"></a></h1>\n<p>The following network messages enable the creation of long living masternode quorums (LLMQs) as described in <a href=\"https://github.com/dashpay/dips/blob/master/dip-0006.md\">DIP6</a>.</p>\n<p>With the exception of the <a href=\"core-ref-p2p-network-quorum-messages#section-qfcommit\"><code>qfcommit</code> message</a>, these messages are for intra-quorum communication only and are not propagated on the Dash network.</p>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qcontrib\"></div>qcontrib<a class=\"fa fa-anchor\" href=\"#section-qcontrib\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>This message is used for intra-quorum communication and is only sent to the &lt;&lt;glossary:masternodes&gt;&gt; in the LLMQ and &lt;&lt;glossary:nodes&gt;&gt; that are monitoring in Watch Mode for auditing/debugging purposes.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qcontrib\"><code>qcontrib</code> message</a> is used by each member of the DKG process to send key contributions to all other members.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>llmqType</td>\n<td>uint8_t</td>\n<td>The type of LLMQ</td>\n</tr>\n<tr>\n<td>32</td>\n<td>quorumHash</td>\n<td>uint256</td>\n<td>The quorum identifier</td>\n</tr>\n<tr>\n<td>32</td>\n<td>proTxHash</td>\n<td>uint256</td>\n<td>The <a href=\"core-ref-transactions-special-transactions#section-proregtx\">ProRegTx</a> hash of the complaining member</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>vvecSize</td>\n<td>compactSize uint</td>\n<td>The size of the verification vector</td>\n</tr>\n<tr>\n<td>48 * <code>vvecSize</code></td>\n<td>vvec</td>\n<td>BLSPubKey[]</td>\n<td>The verification vector</td>\n</tr>\n<tr>\n<td>48</td>\n<td>ephemeralPubKey</td>\n<td>BLSPubKey</td>\n<td>Ephemeral BLS public key used to encrypt secret key contributions</td>\n</tr>\n<tr>\n<td>32</td>\n<td>iv</td>\n<td>uint256</td>\n<td>Initialization vector</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>skCount</td>\n<td>compactSize uint</td>\n<td>Number of encrypted secret key contributions</td>\n</tr>\n<tr>\n<td>(1 + 32) * (<code>skCount</code>)</td>\n<td>skContributions</td>\n<td>byte[]</td>\n<td>Secret key contributions encrypted to recipient masternodes\u2019 BLS public operator key.<br><br>Each contribution consists of:<br>- Size: 1 byte<br>- Secret Key: 32 bytes</td>\n</tr>\n<tr>\n<td>96</td>\n<td>sig</td>\n<td>byte[]</td>\n<td>BLS signature, signed with the operator key of the contributing masternode</td>\n</tr>\n</tbody>\n</table></div>\n<p>More information can be found in the <a href=\"https://github.com/dashpay/dips/blob/master/dip-0006.md#2-contribution-phase\">Contribution phase section of DIP6</a>.</p>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qcontrib\"><code>qcontrib</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">01  ........................................ LLMQ Type: 1 (LLMQ_50_60)\n\ncb9a1552340175a8232437eb8ceceaea\n4b90a0f75caff20ee12d230b00000000 ...........  Quorum Hash\n\ncd1c97c52ccf163ee5dc264d411efc90\nb07729cd34d9d2e7c7b3ca4b2a4e77cf ........... ProRegTx Hash\n\n1e ......................................... Verification Vector Size: 30\n\nVerification Vector (Truncated)\n| 8da71ba5030e28c6c4de5e0eb1660d0f\n| a9fd21ef4fef700a556f10286c9c34fb\n| beb36fffb5b2a552a40d6c8e27aac338\n| [...]\n| 99d8649d226261162bcb5a11617d1732\n| 553b8358d85b1d9e12a88eb3e979fb7c\n| e49b5a21a82a74e9d06233199cb73db4 ......... Verification Vector (1440 bytes)\n\n8d664929b596cdc8eb835d652944d61b\n7fd21fd60ba0288af4f9e3a10658c8a8\n56467082c728e2037791166705ada03a ........... Ephemeral BLS Public Key\n\n93037a05b65adad6f5d44edc43500bff\n71605f0e5f90ab92e3e0b46461c1c64d ........... IV Seed\n\n32 ......................................... Contribution count: 50\nContributions\n| Secret Key Contribution #1\n| | 20 ..................................... Contribution Size: 32 bytes\n| | | 31f3e8e5b2cc2063ee7fd1dd469dca12\n| | | 4bdf506ee46fe825d5537aa3ce838225 ..... Encrypted Secret Key contribution\n|\n| Secret Key Contribution #2\n| | 20 ..................................... Contribution Size: 32 bytes\n| | | a6b3ff696ffc5e0c0a9b444c515edc48\n| | | 5a9ccea0268c2a445fac5e24feda51a9 ..... Encrypted Secret Key contribution\n|\n| [...] .................................... 47 contributions omitted\n|\n| Secret Key Contribution #50\n| | 20 ..................................... Contribution Size: 32 bytes\n| | | 25f54cff411a577db9a416a60067f512\n| | | 0750c77720207eb1484c90767b72faf8 ..... Encrypted Secret Key contribution\n\n81f1003546f6735849c5691af93d324d\n3a719fc4bb6d719907de3bce9833228e\n648d03cd80666d70600fa8c936d30046\n07bd444af3e494fb2a21273fcfa51986\n3c4e139c67d2ffe0df07ac27ae63a0c8\ne000da1aeda5f98ec9e64b801681bfc1 ........... BLS signature (Operator Key)\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qcomplaint\"></div>qcomplaint<a class=\"fa fa-anchor\" href=\"#section-qcomplaint\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>This message is used for intra-quorum communication and is only sent to the &lt;&lt;glossary:masternodes&gt;&gt; in the LLMQ and &lt;&lt;glossary:nodes&gt;&gt; that are monitoring in Watch Mode for auditing/debugging purposes.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qcomplaint\"><code>qcomplaint</code> message</a> is used to notify other members in the DKG process of any members that provided no contribution or an invalid secret key contribution. The notifications are divided into 2 fields:</p>\n<ul>\n<li ><code>badMembers</code> - Sets a bit for each member that failed to provide a contribution</li><li ><code>complaints</code> - Sets a bit for each member that provided an invalid contribution</li></ul>\n<p>If a threshold number of quorum participants indicate a masternode didn&#39;t contribute, that masternode will be excluded from the quorum. Members that simply have a complaint against them are given an opportunity to respond (via a <a href=\"core-ref-p2p-network-quorum-messages#section-qjustify\"><code>qjustify</code> message</a>) to attempt to prove to all participants that they did participate.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>llmqType</td>\n<td>uint8_t</td>\n<td>The type of LLMQ</td>\n</tr>\n<tr>\n<td>32</td>\n<td>quorumHash</td>\n<td>uint256</td>\n<td>The quorum identifier</td>\n</tr>\n<tr>\n<td>32</td>\n<td>proTxHash</td>\n<td>uint256</td>\n<td>The <a href=\"core-ref-transactions-special-transactions#section-proregtx\">ProRegTx</a> hash of the complaining member</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>badBitSize</td>\n<td>compactSize uint</td>\n<td>Number of bits in the bad members bitvector</td>\n</tr>\n<tr>\n<td>(<code>badBitSize</code> + 7) / 8</td>\n<td>badMembers</td>\n<td>byte[]</td>\n<td>The bad members bitvector</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>complaintsBitSize</td>\n<td>compactSize uint</td>\n<td>Number of bits in the complaints bitvector</td>\n</tr>\n<tr>\n<td>(<code>complaints</code><br><code>BitSize</code> + 7) / 8</td>\n<td>complaints</td>\n<td>byte[]</td>\n<td>The complaints bitvector</td>\n</tr>\n<tr>\n<td>96</td>\n<td>sig</td>\n<td>byte[]</td>\n<td>BLS signature, signed with the operator key of the contributing masternode</td>\n</tr>\n</tbody>\n</table></div>\n<p>More information can be found in the <a href=\"https://github.com/dashpay/dips/blob/master/dip-0006.md#3-complaining-phase\">Complaining phase section of DIP6</a>.</p>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qcomplaint\"><code>qcomplaint</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\nb34b2bcb3430f403663e37be9c63c88e\n4ca1f12c41846064cf960a0800000000 ........... Quorum Hash\n\nb375607540bd9c6e4a5452d8c7a6a626\nec715222a0650321487843c79cac67d5 ........... ProRegTx hash\n\n32 ......................................... Bad member bitvector size: 50\n08800200004000 ............................. Bad members\n\n32 ......................................... Complaints bitvector size: 50\n00020080040000 ............................. Complaints\n\n0639b0e8ccb667c161207ddc03183d4e\nbb632eeb60f29e351963032a673abd61\n3fb3e847dff78699481193cf385f0e08\n0fdf518e26ef1e258b724408b1ee9d70\n511696092b6c2ebfad5e24154a7f859f\n0efe3fcb8d7042da624f7298876cc98e ........... BLS signature (Operator Key)\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qjustify\"></div>qjustify<a class=\"fa fa-anchor\" href=\"#section-qjustify\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>This message is used for intra-quorum communication and is only sent to the &lt;&lt;glossary:masternodes&gt;&gt; in the LLMQ and &lt;&lt;glossary:nodes&gt;&gt; that are monitoring in Watch Mode for auditing/debugging purposes.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qjustify\"><code>qjustify</code> message</a> is used to respond to complaints. This provides a way for &lt;&lt;glossary:nodes&gt;&gt; that have been complained about to offer proof of correct behavior. If a valid justification is not provided, all other nodes mark it as a bad. If a valid justification is provided, the complaining node is marked as bad instead (since it submitted a bad complaint).</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>llmqType</td>\n<td>uint8_t</td>\n<td>The type of LLMQ</td>\n</tr>\n<tr>\n<td>32</td>\n<td>quorumHash</td>\n<td>uint256</td>\n<td>The quorum identifier</td>\n</tr>\n<tr>\n<td>32</td>\n<td>proTxHash</td>\n<td>uint256</td>\n<td>The <a href=\"core-ref-transactions-special-transactions#section-proregtx\">ProRegTx</a> hash of the complaining member</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>skContributions<br>Count</td>\n<td>compactSize uint</td>\n<td>Number of unencrypted secret key contributions</td>\n</tr>\n<tr>\n<td>36 * <code>skContributions</code><br><code>Count</code></td>\n<td>skContribution</td>\n<td>SKContribution</td>\n<td>Member index and secret key contribution for members justifying complaints</td>\n</tr>\n<tr>\n<td>96</td>\n<td>sig</td>\n<td>byte[]</td>\n<td>BLS signature, signed with the operator key of the contributing masternode</td>\n</tr>\n</tbody>\n</table></div>\n<p>An <code>SKContribution</code> consists of:</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>4</td>\n<td>skContributionMember</td>\n<td>uint32_t</td>\n<td>Index of the member for which justification is provided</td>\n</tr>\n<tr>\n<td>32</td>\n<td>skContributions</td>\n<td>byte[]</td>\n<td>Unencrypted secret key contribution for the member contained in skContributionMember</td>\n</tr>\n</tbody>\n</table></div>\n<p>More information can be found in the <a href=\"https://github.com/dashpay/dips/blob/master/dip-0006.md#4-justification-phase\">Justification phase section of DIP6</a>.</p>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qjustify\"><code>qjustify</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\nb34b2bcb3430f403663e37be9c63c88e\n4ca1f12c41846064cf960a0800000000 ........... Quorum Hash\n\ne7d909afba6848f3fdf98b2da31db07e\n3fbee621d58c469dce96d6283bcd4b25 ........... ProRegTx hash\n\n05 ......................................... Contribution count: 5\n\nContribution #1\n| 16000000 ................................. Member Index: 22\n|\n| 57b63ec5ae0a101f0d93bb60af70bf22\n| c21bd3a7705e1aecb9559d6b151d953f ......... Unencrypted secret key contribution\n\nContribution #2\n| 17000000 ................................. Member Index: 22\n|\n| 0ee1f0f0f2570589e81d2a4f8165b105\n| 28436a1a75cf3469fa81090f2d856150 ......... Unencrypted secret key contribution\n\n[...] ...................................... 3 more contributions omitted\n\n8d63d10e242ac97c6324e9a40d6e690e\n4bb7fe0750b7d204f7e988a324720189\n68408d2d0621bbaba8380ad4aaf342ea\n138ce9a59ed9ca82995c155609488dcc\n5ac35f483b695a0624e5ab0745f7f9e2\n051edf1b3b1f0e1b1d55d185d25e0ed7 ........... BLS signature (Operator Key)\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qpcommit\"></div>qpcommit<a class=\"fa fa-anchor\" href=\"#section-qpcommit\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>This message is used for intra-quorum communication and is only sent to the &lt;&lt;glossary:masternodes&gt;&gt; in the LLMQ and &lt;&lt;glossary:nodes&gt;&gt; that are monitoring in Watch Mode for auditing/debugging purposes.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qpcommit\"><code>qpcommit</code> message</a> is used to exchange premature commitment messages for verification and selection of the final commitment.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>llmqType</td>\n<td>uint8_t</td>\n<td>The type of LLMQ</td>\n</tr>\n<tr>\n<td>32</td>\n<td>quorumHash</td>\n<td>uint256</td>\n<td>The quorum identifier</td>\n</tr>\n<tr>\n<td>32</td>\n<td>proTxHash</td>\n<td>uint256</td>\n<td>The <a href=\"core-ref-transactions-special-transactions#section-proregtx\">ProRegTx</a> hash of the complaining member</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>validMembersSize</td>\n<td>compactSize uint</td>\n<td>Bit size of the <code>validMembers</code> bitvector</td>\n</tr>\n<tr>\n<td>(<code>valid</code><br><code>MembersSize</code> + 7) / 8</td>\n<td>validMembers</td>\n<td>byte[]</td>\n<td>Bitset of valid members in this commitment</td>\n</tr>\n<tr>\n<td>48</td>\n<td>quorumPublicKey</td>\n<td>uint256</td>\n<td>The quorum public key</td>\n</tr>\n<tr>\n<td>32</td>\n<td>quorumVvecHash</td>\n<td>byte[]</td>\n<td>The hash of the quorum verification vector</td>\n</tr>\n<tr>\n<td>96</td>\n<td>quorumSig</td>\n<td>BLSSig</td>\n<td>Threshold signature, signed with the threshold signature share of the committing member</td>\n</tr>\n<tr>\n<td>96</td>\n<td>sig</td>\n<td>byte[]</td>\n<td>BLS signature, signed with the operator key of the contributing masternode</td>\n</tr>\n</tbody>\n</table></div>\n<p>More information can be found in the <a href=\"https://github.com/dashpay/dips/blob/master/dip-0006.md#5-commitment-phase\">Commitment phase section of DIP6</a>.</p>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qpcommit\"><code>qpcommit</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\ncb9a1552340175a8232437eb8ceceaea\n4b90a0f75caff20ee12d230b00000000 ........... Quorum Hash\n\n59c38b8d6a0664411f92a6326e8ef070\n7ecf185405252854ddb477d89127a32d ........... ProRegTx hash\n\n32 ......................................... Valid member bitvector size: 50\nffffffffffff03 ............................. Valid members\n\n102809b8649209a15fceb3984014eb39\n70ca9bd2464b2f84353a3353f4d612eb\n7ca6daaf723170cdbdad40c5cf44f87b ........... Quorum BLS Public Key\n\n17431ce7dfecb9bba4ccba5921514d24\nfe267c61078bdfe29d90774a3b766ad5 ........... Quorum Verification Vector Hash\n\n94f7417e0ed56ada7116cf4f1e400748\ndeb2e2040babd540f21925b2eec8d4df\n75d3e0fc3323d083db76f66ce6128a13\n0f1b2c4725076dae2283bbecbf2e1230\n72cc9cec244337008bf82a670ab9e2ee\n6220dd736a1a70c9ca87867ca55f8665 ........... BLS Threshold signature\n\n85723fe503bba8ac814eab0f28f1fd07\n49927528c01b635d11d3f2843ce3f7e1\n6223c7e9a9e1f70916159c965acae8bf\n09d16dc85267ec4081907adc966eae69\nb6a5077267fdc61cdb192faffa27bed9\n2883559bab2ab81cef6253452622b30c ........... BLS signature (Operator Key)\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qfcommit\"></div>qfcommit<a class=\"fa fa-anchor\" href=\"#section-qfcommit\"></a></h2>\n<p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qfcommit\"><code>qfcommit</code> message</a> is used to finalize a &lt;&lt;glossary:Long-Living Masternode Quorum&gt;&gt; setup by aggregating the information necessary to mine the on-chain <a href=\"core-ref-transactions-special-transactions#section-qctx\">QcTx</a> special transaction. The message contains all the necessary information required to validate the long-living masternode quorum&#39;s signing results.</p>\n<p>It is possible to receive multiple valid final commitments for the same DKG session. These should only differ in the number of signers, which can be ignored as long as there are at least <code>quorumThreshold</code> number of signers. The set of valid members for these final commitments should always be the same, as each member only creates a single premature commitment. This means that only one set of valid members (and thus only one quorum verification vector and quorum &lt;&lt;glossary:public key&gt;&gt;) can gain a majority. If the threshold is not reached, there will be no valid final commitment.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>2</td>\n<td>version</td>\n<td>uint16_t</td>\n<td>Version of the final commitment message</td>\n</tr>\n<tr>\n<td>1</td>\n<td>llmqType</td>\n<td>uint8_t</td>\n<td>The type of LLMQ</td>\n</tr>\n<tr>\n<td>32</td>\n<td>quorumHash</td>\n<td>uint256</td>\n<td>The quorum identifier</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>signersSize</td>\n<td>compactSize uint</td>\n<td>Bit size of the signers bitvector</td>\n</tr>\n<tr>\n<td>(bitSize + 7) / 8</td>\n<td>signers</td>\n<td>byte[]</td>\n<td>Bitset representing the aggregated signers of this final commitment</td>\n</tr>\n<tr>\n<td>1-9</td>\n<td>validMembersSize</td>\n<td>compactSize uint</td>\n<td>Bit size of the <code>validMembers</code> bitvector</td>\n</tr>\n<tr>\n<td>(bitSize + 7) / 8</td>\n<td>validMembers</td>\n<td>byte[]</td>\n<td>Bitset of valid members in this commitment</td>\n</tr>\n<tr>\n<td>48</td>\n<td>quorumPublicKey</td>\n<td>BLSPubKey</td>\n<td>The quorum public key</td>\n</tr>\n<tr>\n<td>32</td>\n<td>quorumVvecHash</td>\n<td>uint256</td>\n<td>The hash of the quorum verification vector</td>\n</tr>\n<tr>\n<td>96</td>\n<td>quorumSig</td>\n<td>byte[]</td>\n<td>Recovered threshold signature</td>\n</tr>\n<tr>\n<td>96</td>\n<td>sig</td>\n<td>byte[]</td>\n<td>Aggregated BLS signatures from all included commitments</td>\n</tr>\n</tbody>\n</table></div>\n<p>More information can be found in the <a href=\"https://github.com/dashpay/dips/blob/master/dip-0006.md#6-finalization-phase\">Finalization phase section of DIP6</a>.</p>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qfcommit\"><code>qfcommit</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">0100 ....................................... Message Version: 1\n01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\ncb9a1552340175a8232437eb8ceceaea\n4b90a0f75caff20ee12d230b00000000 ........... Quorum Hash\n\n32 ......................................... Signer bitvector size: 50\nffffffffffff03 ............................. Signers\n\n32 ......................................... Valid member bitvector size: 50\nffffffffffff03 ............................. Valid members\n\n102809b8649209a15fceb3984014eb39\n70ca9bd2464b2f84353a3353f4d612eb\n7ca6daaf723170cdbdad40c5cf44f87b ........... Quorum BLS Public Key\n\n17431ce7dfecb9bba4ccba5921514d24\nfe267c61078bdfe29d90774a3b766ad5 ........... Quorum Verification Vector Hash\n\n083388b91a2f8f7f4ea35469f25ee16a\n21b3e03b02936675897f74424d6de748\n66b34dcc5861fd3f5f661ea1ed124a08\n0b165f21b1f2db18c4c37c82f8a8d350\n9a6f52a14c643dab71a4dced78ae9a42\ndc982e89a92606df537b8918881e9c95 ........... Quorum BLS Recovered Threshold Sig\n\n0d131c7062253671f9c8ebb39a9b0057\nd78dc67e236b55086cbb0624c7f4abcc\n0a26557bfad3092bd38ded4e3cca6c43\n0dda2e73a99ca3d359631cb99a121c5e\n92cea06ef4c03bb18ad9e90559104550\nc8a042dc51aa58a26c134405fc3234ff ........... Quorum Aggregate BLS Sig\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-signing-sessions\"></div>Signing Sessions<a class=\"fa fa-anchor\" href=\"#section-signing-sessions\"></a></h1>\n<p>The following network messages enable the long living masternode quorum (LLMQ) message signing sessions described in <a href=\"https://github.com/dashpay/dips/blob/master/dip-0007.md\">DIP7</a>.</p>\n<p>With the exception of the <a href=\"core-ref-p2p-network-quorum-messages#section-qsendrecsigs\"><code>qsendrecsigs</code> message</a> and the <a href=\"core-ref-p2p-network-quorum-messages#section-qsigrec\"><code>qsigrec</code> message</a>, these messages are for intra-quorum communication only and are not propagated on the Dash network.</p>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qbsigs\"></div>qbsigs<a class=\"fa fa-anchor\" href=\"#section-qbsigs\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>This message is used for intra-quorum communication and is only sent to the &lt;&lt;glossary:masternodes&gt;&gt; in the LLMQ and &lt;&lt;glossary:nodes&gt;&gt; that are monitoring in Watch Mode for auditing/debugging purposes.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qbsigs\"><code>qbsigs</code> message</a> is used to send batched signature shares in response to a <a href=\"core-ref-p2p-network-quorum-messages#section-qgetsigs\"><code>qgetsigs</code> message</a>.</p>\n\n</div>\n<div class=\"magic-block-callout type-info no-title\"><span class=\"noTitleIcon\"><i title=\"Info\" class=\"fa fa-info-circle\"></i></span>\n\t<div class=\"callout-body\"><p>The number of messages that can be sent in a batch is limited to 400 (as defined by <code>MAX_MSGS_TOTAL_BATCHED_SIGS</code> in Dash Core).</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Varies</td>\n<td>batchCount</td>\n<td>compactSize uint</td>\n<td>Number of batched signature shares</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>msgs</td>\n<td>CBatchedSigShares</td>\n<td>Batches of signature shares</td>\n</tr>\n</tbody>\n</table></div>\n<p>CBatchedSigShares:</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Varies</td>\n<td>sessionId</td>\n<td>varint</td>\n<td>Signing session ID</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>shareCount</td>\n<td>compactSize uint</td>\n<td>Number of shares</td>\n</tr>\n<tr>\n<td>shareCount * 98</td>\n<td>sigShares</td>\n<td>&lt;uint16_t, CBLSLazySignature&gt;</td>\n<td>Index (2 bytes) and BLS Signature share (96 bytes)</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qbsigs\"><code>qbsigs</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">02 ......................................... Number of signature share batches: 2\n\nSignature Share Batch 1\n| 84d843 ................................... Session ID\n|\n| 01 ....................................... Share count: 1\n|\n| Share\n| | 2100 ................................... Index\n|\n| | 0fbd0c0981b79544c3e80d1a2eed13fe\n| | f08c731b0156654675209812f9b2b8f3\n| | ec23868d26890a0e85e5cec4ad0e2d46\n| | 01293cf7e41841fda5865063e7354f36\n| | e8a5c13d2c2d265a778f41e807b3cc63\n| | 81e202ecf923c62bbb69ecc713bdf86d ....... BLS Signature share\n\nSignature Share Batch 2\n| 84d844 ................................... Session ID\n|\n| 01 ....................................... Share Count: 1\n|\n| Share\n| | 2100 ................................... Index\n| |\n| | 9570d97e41b78045b51fba3d4f1ea38d\n| | 7a0e007535ce6beb1e03eff163b421fd\n| | b8125142a12f92aa82770de7bb038207\n| | 13ccc72dd6d9bf91ecc2835da54a0afb\n| | 0c0fa5d7a214a020ca650ca202ddff29\n| | c3cac4033098297d2aaee098db5bfe2f ....... BLS Signature share\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qgetsigs\"></div>qgetsigs<a class=\"fa fa-anchor\" href=\"#section-qgetsigs\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>This message is used for intra-quorum communication and is only sent to the &lt;&lt;glossary:masternodes&gt;&gt; in the LLMQ and &lt;&lt;glossary:nodes&gt;&gt; that are monitoring in Watch Mode for auditing/debugging purposes.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qgetsigs\"><code>qgetsigs</code> message</a> is used to request signature shares. The response to a <a href=\"core-ref-p2p-network-quorum-messages#section-qgetsigs\"><code>qgetsigs</code> message</a> is a <a href=\"core-ref-p2p-network-quorum-messages#section-qbsigs\"><code>qbsigs</code> message</a>.</p>\n\n</div>\n<div class=\"magic-block-callout type-info no-title\"><span class=\"noTitleIcon\"><i title=\"Info\" class=\"fa fa-info-circle\"></i></span>\n\t<div class=\"callout-body\"><p>The number of inventories in a <a href=\"core-ref-p2p-network-quorum-messages#section-qgetsigs\"><code>qgetsigs</code> message</a> is limited to 200 (as defined by <code>MAX_MSGS_CNT_QGETSIGSHARES</code> in Dash Core).</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Varies</td>\n<td>count</td>\n<td>compactSize uint</td>\n<td>Number of signature shares requested</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>sessionId</td>\n<td>varint</td>\n<td>Signing session ID</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>invSize</td>\n<td>compactSize uint</td>\n<td>Inventory size</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>inv</td>\n<td>CAutoBitSet</td>\n<td>Quorum signature inventory</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qgetsigs\"><code>qgetsigs</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">02 ......................................... Count: 2\n\nSignature share request 1\n| 80db21 ................................... Session ID\n| 32 ....................................... Inventory size: 50\n| 012900 ................................... Inventory\n\nSignature share request 2\n| 80db22 ................................... Session ID\n| 32 ....................................... Inventory Size: 50\n| 012900 ................................... Inventory\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qsendrecsigs\"></div>qsendrecsigs<a class=\"fa fa-anchor\" href=\"#section-qsendrecsigs\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n<p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qsendrecsigs\"><code>qsendrecsigs</code> message</a> is used to notify a &lt;&lt;glossary:peer&gt;&gt; to send plain &lt;&lt;glossary:LLMQ&gt;&gt; recovered signatures (inventory type <code>MSG_QUORUM_RECOVERED_SIG</code>). Otherwise the peer would only announce/send the higher level messages produced when a recovered signature is found (e.g. InstantSend <a href=\"core-ref-p2p-network-instantsend-messages#section-islock\"><code>islock</code> messages</a> or ChainLock <a href=\"core-ref-p2p-network-instantsend-messages#section-clsig\"><code>clsig</code> messages</a>).</p>\n\n</div>\n<div class=\"magic-block-callout type-info no-title\"><span class=\"noTitleIcon\"><i title=\"Info\" class=\"fa fa-info-circle\"></i></span>\n\t<div class=\"callout-body\"><p>SPV nodes should not send this message as they are usually only interested in the higher level messages.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>fSendRecSigs</td>\n<td>bool</td>\n<td>0 - Notify peer to not send plain LLMQ recovered signatures<br>1 - Notify peer to send plain LLMQ recovered signatures (default for Dash Core nodes)</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qsendrecsigs\"><code>qsendrecsigs</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">01 ................................. Request recovered signatures: Enabled (1)\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qsigrec\"></div>qsigrec<a class=\"fa fa-anchor\" href=\"#section-qsigrec\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n<p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qsigrec\"><code>qsigrec</code> message</a> is used to provide recovered signatures and related quorum details to &lt;&lt;glossary:nodes&gt;&gt; that have requested this information via the <a href=\"core-ref-p2p-network-quorum-messages#section-qsendrecsigs\"><code>qsendrecsigs</code> message</a>.</p>\n<div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>llmqType</td>\n<td>uint8_t</td>\n<td>The type of LLMQ</td>\n</tr>\n<tr>\n<td>32</td>\n<td>quorumHash</td>\n<td>uint256</td>\n<td>The quorum hash</td>\n</tr>\n<tr>\n<td>32</td>\n<td>id</td>\n<td>uint256</td>\n<td>The signing request id</td>\n</tr>\n<tr>\n<td>32</td>\n<td>msgHash</td>\n<td>uint256</td>\n<td>The message hash</td>\n</tr>\n<tr>\n<td>96</td>\n<td>sig</td>\n<td>byte[]</td>\n<td>The final recovered BLS threshold signature</td>\n</tr>\n</tbody>\n</table></div>\n<p>More information can be found in the <a href=\"https://github.com/dashpay/dips/blob/master/dip-0007.md#recovered-threshold-signatures\">Recovered threshold signatures section of DIP7</a>.</p>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qsigrec\"><code>qsigrec</code> message</a>. (The message header has been omitted.)</p>\n<p><strong>Note:</strong> The following <a href=\"core-ref-p2p-network-quorum-messages#section-qsigrec\"><code>qsigrec</code> message</a> corresponds to the example <a href=\"core-ref-p2p-network-instantsend-messages#section-islock\"><code>islock</code> message</a> hexdump. The message hash below corresponds to the <code>islock</code> TXID field and the BLS signature matches the BLS signature of the <code>islock</code> example.</p>\n<pre><code class=\"lang-text\">01 ......................................... LLMQ Type: 1 (LLMQ_50_60)\n\n7d0befca14fa9e594aa19deab138ef28\n23fe838c89ed9be6ddc63c0200000000 ........... Quorum Hash\n\n0f1937c60f35640d063eae8eb288af21\na2ec0ec69b58b20c52f5d438eaabd54d ........... Signing Request ID\n\ne2e1c797576d8b13c83e929684b9aacd\n553c20a34e2d11e38bdcaaf8e1de1680 ........... Message Hash\n\n0f055c2064885d446f83d51b9bb09892\n7ea0375a0f6a3f3402abf158ece67e00\n81049b8a8f45d254b64574cef194ef31\n197e450fba1196d652f2e1421d3b80ae\nf429c10eabd4ab9289e9a8f80f6989b7\na11e5e7930deccc3e11a931fc9524f06 ........... LLMQ BLS Signature (96 bytes)\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qsigsesann\"></div>qsigsesann<a class=\"fa fa-anchor\" href=\"#section-qsigsesann\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>This message is used for intra-quorum communication and is only sent to the &lt;&lt;glossary:masternodes&gt;&gt; in the LLMQ and &lt;&lt;glossary:nodes&gt;&gt; that are monitoring in Watch Mode for auditing/debugging purposes.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qsigsesann\"><code>qsigsesann</code> message</a> is used to announce the sessionId for a signing session. The sessionId will be used for all P2P messages related to that session.</p>\n\n</div>\n<div class=\"magic-block-callout type-info no-title\"><span class=\"noTitleIcon\"><i title=\"Info\" class=\"fa fa-info-circle\"></i></span>\n\t<div class=\"callout-body\"><p>The maximum number of announcements in a <a href=\"core-ref-p2p-network-quorum-messages#section-qsigsesann\"><code>qsigsesann</code> message</a> is limited to 100 (as defined by <code>MAX_MSGS_CNT_QSIGSESANN</code> in Dash Core).</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Varies</td>\n<td>count</td>\n<td>compactSize uint</td>\n<td>Number of session announcements</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>sessionId</td>\n<td>varint</td>\n<td>Signing session ID (must be less than the maximum uint32_t value)</td>\n</tr>\n<tr>\n<td>1</td>\n<td>llmqType</td>\n<td>uint8_t</td>\n<td>The LLMQ type</td>\n</tr>\n<tr>\n<td>32</td>\n<td>quorumHash</td>\n<td>uint256</td>\n<td>The quorum identifier</td>\n</tr>\n<tr>\n<td>32</td>\n<td>id</td>\n<td>uint256</td>\n<td>The signing request id</td>\n</tr>\n<tr>\n<td>32</td>\n<td>msgHash</td>\n<td>uint256</td>\n<td>The message hash</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qsigsesann\"><code>qsigsesann</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">02 ......................................... Count: 2\n\nSession Announcement 1\n| 84d843 ................................... Session ID\n|\n| 01 ....................................... LLMQ Type: 1 (LLMQ_50_60)\n|\n| a34d3ae6b33cb1199c3e5e1cb5a2a55c\n| 91e69bb5df2bf80ba1cb0a0d00000000 ......... Quorum Hash\n|\n| 89bbc2e5741a9f706e8d33dee4132037\n| 8c33511768c5e3d6cdb2a1b7b731360b ......... Signing request ID\n|\n| d2b41a19237e370b4b091545b203bc0c\n| 02ca7e0d5daebf12bb24b13064ed4149 ......... Message Hash\n\nSession Announcement 2\n| 84d844 ................................... Session ID\n|\n| 01 ....................................... LLMQ Type: 1 (LLMQ_50_60)\n|\n| a34d3ae6b33cb1199c3e5e1cb5a2a55c\n| 91e69bb5df2bf80ba1cb0a0d00000000 ......... Quorum Hash\n|\n| 54f73deb42a8ed9b72b9c0535a72f54d\n| 5789bbe0dbea2e184c3089f9e8f65c3e ......... Signing request ID\n|\n| af2e5d730cd37cd911b92db117b4ab99\n| 90a3c0300ce39177d0d31be5b47c2361 ......... Message Hash\n</code></pre>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qsigsinv\"></div>qsigsinv<a class=\"fa fa-anchor\" href=\"#section-qsigsinv\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n\n</div>\n<div class=\"magic-block-callout type-warning no-title\"><span class=\"noTitleIcon\"><i title=\"Warning\" class=\"fa fa-exclamation-circle\"></i></span>\n\t<div class=\"callout-body\"><p>This message is used for intra-quorum communication and is only sent to the &lt;&lt;glossary:masternodes&gt;&gt; in the LLMQ and &lt;&lt;glossary:nodes&gt;&gt; that are monitoring in Watch Mode for auditing/debugging purposes.</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qsigsinv\"><code>qsigsinv</code> message</a> (quorum signature inventory) announces one or more quorum signature share inventories known by the transmitting peer.</p>\n\n</div>\n<div class=\"magic-block-callout type-info no-title\"><span class=\"noTitleIcon\"><i title=\"Info\" class=\"fa fa-info-circle\"></i></span>\n\t<div class=\"callout-body\"><p>The maximum number of inventories in a <a href=\"core-ref-p2p-network-quorum-messages#section-qsigsinv\"><code>qsigsinv</code> message</a> is limited to 200 (as defined by <code>MAX_MSGS_CNT_QSIGSHARESINV</code> in Dash Core).</p>\n\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><div class=\"marked-table\"><table>\n<thead>\n<tr>\n<th>Bytes</th>\n<th>Name</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Varies</td>\n<td>count</td>\n<td>compactSize uint</td>\n<td>Number of session announcements</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>sessionId</td>\n<td>varint</td>\n<td>Signing session ID (must be less than the maximum uint32_t value)</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>invSize</td>\n<td>compactSize uint</td>\n<td>Inventory size</td>\n</tr>\n<tr>\n<td>Varies</td>\n<td>inv</td>\n<td>CAutoBitSet</td>\n<td>Quorum signature inventory</td>\n</tr>\n</tbody>\n</table></div>\n<p>The following annotated hexdump shows a <a href=\"core-ref-p2p-network-quorum-messages#section-qsigsinv\"><code>qsigsinv</code> message</a>. (The message header has been omitted.)</p>\n<pre><code class=\"lang-text\">02 ......................................... Count: 2\n\n84d844 ..................................... Session ID\n32 ......................................... Inventory size: 50\n011a040200 ................................. Inventory\n\n84d843 ..................................... Session ID\n32 ......................................... Inventory size: 50\n011a0700 ................................... Inventory\n</code></pre>\n<h1 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-debugging\"></div>Debugging<a class=\"fa fa-anchor\" href=\"#section-debugging\"></a></h1>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-qwatch\"></div>qwatch<a class=\"fa fa-anchor\" href=\"#section-qwatch\"></a></h2>\n<p><em>Added in protocol version 70214 of Dash Core</em></p>\n<p>The <a href=\"core-ref-p2p-network-quorum-messages#section-qwatch\"><code>qwatch</code> message</a> tells the receiving &lt;&lt;glossary:peer&gt;&gt; to relay &lt;&lt;glossary:LLMQ&gt;&gt; messages (<code>qcontrib</code> messages, <a href=\"core-ref-p2p-network-quorum-messages#section-qcomplaint\"><code>qcomplaint</code> messages</a>, <a href=\"core-ref-p2p-network-quorum-messages#section-qjustify\"><code>qjustify</code> messages</a>, and <a href=\"core-ref-p2p-network-quorum-messages#section-qpcommit\"><code>qpcommit</code> messages</a>).</p>\n<p>There is no payload in a <a href=\"core-ref-p2p-network-quorum-messages#section-qwatch\"><code>qwatch</code> message</a>.  See the <a href=\"core-ref-p2p-network-message-headers\">message header section</a> for an example of a message without a payload.</p>\n\n</div>"
}